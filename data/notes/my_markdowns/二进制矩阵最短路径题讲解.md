# äºŒè¿›åˆ¶çŸ©é˜µæœ€çŸ­è·¯å¾„é¢˜è®²è§£

## ğŸ§‘â€ğŸ’» User

è®²è§£åŠ›æ‰£é¢˜ç›®1091. äºŒè¿›åˆ¶çŸ©é˜µä¸­çš„æœ€çŸ­è·¯å¾„

---
## ğŸ¤– Assistant

**é¢˜ç›®ï¼šLeetCode 1091. äºŒè¿›åˆ¶çŸ©é˜µä¸­çš„æœ€çŸ­è·¯å¾„**

---

## 1. é¢˜æ„ & æœ¬è´¨

- ç»™ä¸€ä¸ª `n x n` çš„æ–¹é˜µ `grid`ï¼ŒåªåŒ…å« `0` å’Œ `1`
 - `0`ï¼šå¯èµ°
 - `1`ï¼šéšœç¢
- èµ·ç‚¹æ˜¯å·¦ä¸Šè§’ `(0, 0)`ï¼Œç»ˆç‚¹æ˜¯å³ä¸‹è§’ `(n-1, n-1)`
- ä¸€æ¬¡å¯ä»¥å‘ **8 ä¸ªæ–¹å‘** èµ°ï¼šä¸Šä¸‹å·¦å³ + å››ä¸ªå¯¹è§’çº¿
- æ¯ç§»åŠ¨ä¸€æ ¼ï¼Œè·¯å¾„é•¿åº¦ +1ï¼Œè·¯å¾„é•¿åº¦æ˜¯ **ç»è¿‡çš„æ ¼å­æ•°**ï¼ˆåŒ…æ‹¬èµ·ç‚¹å’Œç»ˆç‚¹ï¼‰
- é—®ï¼šä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ï¼Œå¦‚æœèµ°ä¸åˆ°ï¼Œè¿”å› -1

**æœ¬è´¨**ï¼šè¿™æ˜¯ä¸€ä¸ª **æ— æƒå›¾çš„æœ€çŸ­è·¯å¾„é—®é¢˜**ï¼Œç”¨ **BFSï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰** æœ€åˆé€‚ã€‚

---

## 2. ä¸ºä»€ä¹ˆç”¨ BFSï¼Ÿ

- æŠŠæ¯ä¸ªå€¼ä¸º `0` çš„æ ¼å­å½“æˆå›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹
- ç›¸é‚»çš„ 8 ä¸ªæ–¹å‘ã€ä¸”å€¼ä¸º `0` çš„æ ¼å­ä¹‹é—´æœ‰è¾¹ï¼Œè¾¹æƒç»Ÿä¸€ä¸º 1ï¼ˆæ— æƒå›¾ï¼‰
- åœ¨æ— æƒå›¾é‡Œï¼š
**BFS æ˜¯æŒ‰å±‚æ‰©å±•çš„ï¼Œç¬¬ä¸€æ¬¡åˆ°è¾¾ç»ˆç‚¹çš„é‚£ä¸€å±‚ï¼Œå°±æ˜¯æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚**

ç›¸æ¯”ä¹‹ä¸‹ï¼š
- DFSï¼šä¼šèµ°å¾ˆå¤šå†¤æ‰è·¯ï¼Œä¸èƒ½ä¿è¯æœ€å…ˆæ‰¾åˆ°çš„æ˜¯æœ€çŸ­è·¯å¾„
- Dijkstraï¼šå¯ä»¥è§£ï¼Œä½†è¿™æ˜¯æ— æƒå›¾ï¼Œä¸Š Dijkstra æ˜¯æµªè´¹

---

## 3. å…·ä½“åšæ³•ï¼ˆBFSï¼‰

### 3.1 æ­¥éª¤

1. **èµ·ç‚¹/ç»ˆç‚¹åˆæ³•æ€§æ£€æŸ¥**
 - å¦‚æœ `grid[^0][^0] == 1` æˆ– `grid[n-1][n-1] == 1`ï¼Œç›´æ¥è¿”å› `-1`
 - å¦‚æœ `n == 1` ä¸” `grid[^0][^0] == 0`ï¼Œç­”æ¡ˆå°±æ˜¯ `1`

2. **åˆå§‹åŒ– BFS**
 - ä½¿ç”¨é˜Ÿåˆ— `queue`ï¼ˆ`collections.deque`ï¼‰
 - é˜Ÿåˆ—å…ƒç´ ä¸º `(row, col, dist)`ï¼Œå…¶ä¸­ `dist` æ˜¯ä»èµ·ç‚¹åˆ°å½“å‰æ ¼å­çš„è·¯å¾„é•¿åº¦
 - èµ·ç‚¹å…¥é˜Ÿï¼š`(0, 0, 1)`ï¼ˆå› ä¸ºè·¯å¾„é•¿åº¦åŒ…å«èµ·ç‚¹è¿™ä¸ªæ ¼å­ï¼‰

3. **æ ‡è®°å·²è®¿é—®**
 - é˜²æ­¢é‡å¤è®¿é—®/æ­»å¾ªç¯
 - ç®€å•åšæ³•ï¼š**å¤ç”¨åŸçŸ©é˜µ**ï¼ŒæŠŠè®¿é—®è¿‡çš„ `0` æ”¹æˆ `1`ï¼ˆåæ­£ `1` æœ¬èº«å°±è¡¨ç¤ºä¸èƒ½å†èµ°ï¼‰

4. **BFS å¾ªç¯**
 - å½“é˜Ÿåˆ—ä¸ç©ºæ—¶ï¼š
 - å¼¹å‡ºå½“å‰æ ¼å­ `(r, c, dist)`
 - å¦‚æœå½“å‰æ˜¯ç»ˆç‚¹ `(n-1, n-1)`ï¼Œç›´æ¥è¿”å› `dist`
 - æšä¸¾ 8 ä¸ªæ–¹å‘çš„é‚»å±… `(nr, nc)`ï¼š
 - å¦‚æœåœ¨è¾¹ç•Œå†…ã€ä¸” `grid[nr][nc] == 0`ï¼ˆå¯èµ°ä¸”æ²¡è®¿é—®è¿‡ï¼‰
 - æ ‡è®°ä¸ºå·²è®¿é—®ï¼š`grid[nr][nc] = 1`
 - å…¥é˜Ÿ `(nr, nc, dist + 1)`

5. **é˜Ÿåˆ—ç©ºäº†è¿˜æ²¡åˆ°ç»ˆç‚¹**
 - è¯´æ˜ä¸å­˜åœ¨ä»»ä½•å¯è¡Œè·¯å¾„ï¼Œè¿”å› `-1`

### 3.2 æ—¶é—´ & ç©ºé—´å¤æ‚åº¦

- æ¯ä¸ªæ ¼å­æœ€å¤šè¿›é˜Ÿä¸€æ¬¡ï¼Œæœ€å¤šæ£€æŸ¥ 8 ä¸ªæ–¹å‘ï¼š
**æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²)**
- é¢å¤–ç©ºé—´ä¸»è¦æ˜¯é˜Ÿåˆ—ï¼š
**ç©ºé—´å¤æ‚åº¦ï¼šO(nÂ²)**

---

## 4. é¢è¯•ä¸­ 30 ç§’å£è¿°æ€è·¯ï¼ˆå¯ç›´æ¥èƒŒï¼‰

> è¿™é¢˜å¯ä»¥çœ‹æˆæ— æƒå›¾ä¸Šçš„æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œæ¯ä¸ªå€¼ä¸º 0 çš„æ ¼å­æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›¸é‚» 8 ä¸ªæ–¹å‘çš„ 0 ä¹‹é—´æœ‰è¾¹ã€‚
> æ— æƒå›¾æœ€çŸ­è·¯ç”¨ BFS æœ€åˆé€‚ï¼Œå› ä¸º BFS æ˜¯æŒ‰å±‚æ‰©å±•çš„ï¼Œç¬¬ä¸€æ¬¡èµ°åˆ°ç»ˆç‚¹çš„é‚£ä¸€å±‚å°±æ˜¯æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚
> å…·ä½“åšæ³•æ˜¯ï¼šå¦‚æœèµ·ç‚¹æˆ–ç»ˆç‚¹æ˜¯ 1 ç›´æ¥è¿”å› -1ï¼›å¦åˆ™ç”¨é˜Ÿåˆ—ä» `(0,0)` å¼€å§‹ BFSï¼Œé˜Ÿåˆ—é‡Œå­˜ `(è¡Œ, åˆ—, å½“å‰è·ç¦»)`ï¼Œæ¯æ¬¡æŠŠ 8 ä¸ªæ–¹å‘ä¸­åœ¨è¾¹ç•Œå†…ä¸”ä¸º 0 çš„æ ¼å­å…¥é˜Ÿï¼Œå¹¶ç”¨ä¿®æ”¹ grid çš„æ–¹å¼æ ‡è®°è®¿é—®è¿‡ã€‚ç¬¬ä¸€æ¬¡å¼¹å‡ºç»ˆç‚¹æ—¶è¿”å›å¯¹åº”è·ç¦»ï¼Œå¦‚æœ BFS ç»“æŸæ²¡åˆ°ç»ˆç‚¹å°±è¿”å› -1ã€‚æ—¶é—´å¤æ‚åº¦ O(nÂ²)ã€‚

---

## 5. ä»£ç ï¼ˆPythonï¼ŒBFSï¼‰

```python
from collections import deque
from typing import List


class Solution:
    def shortestPathBinaryMatrix(self, grid: List[List[int]]) -> int:
        """è®¡ç®—äºŒè¿›åˆ¶çŸ©é˜µä¸­ä»å·¦ä¸Šåˆ°å³ä¸‹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ï¼ˆ8æ–¹å‘ç§»åŠ¨ï¼‰.

        BFS æ±‚æ— æƒå›¾çš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚
        æ¯ä¸ª 0 æ ¼å­æ˜¯èŠ‚ç‚¹ï¼Œ8 ä¸ªæ–¹å‘çš„ç›¸é‚» 0 ä¹‹é—´å­˜åœ¨è¾¹ã€‚

        Args:
            grid: n x n çš„äºŒè¿›åˆ¶çŸ©é˜µï¼Œ0 è¡¨ç¤ºç©ºåœ°ï¼Œ1 è¡¨ç¤ºéšœç¢ã€‚

        Returns:
            æœ€çŸ­è·¯å¾„é•¿åº¦ï¼›å¦‚æœä¸å­˜åœ¨ä»»ä½•å¯è¡Œè·¯å¾„åˆ™è¿”å› -1ã€‚
        """
        n = len(grid)

        # èµ·ç‚¹æˆ–ç»ˆç‚¹æ˜¯éšœç¢ï¼Œç›´æ¥æ— è§£
        if grid[0][0] == 1 or grid[n - 1][n - 1] == 1:
            return -1

        # ç‰¹æ®Šæƒ…å†µï¼š1x1 ä¸”å¯èµ°
        if n == 1:
            return 1

        # å…«ä¸ªæ–¹å‘ï¼šä¸Šã€ä¸‹ã€å·¦ã€å³ä»¥åŠå››ä¸ªå¯¹è§’çº¿
        directions = [
            (-1, -1), (-1, 0), (-1, 1),
            (0, -1),           (0, 1),
            (1, -1),  (1, 0),  (1, 1),
        ]

        queue = deque()
        # èµ·ç‚¹åæ ‡ (0, 0)ï¼Œè·¯å¾„é•¿åº¦ä¸º 1ï¼ˆåŒ…å«èµ·ç‚¹ï¼‰
        queue.append((0, 0, 1))
        # å¤ç”¨ grid æ ‡è®°å·²è®¿é—®ï¼šæŠŠ 0 æ”¹æˆ 1
        grid[0][0] = 1

        while queue:
            r, c, dist = queue.popleft()

            # å¦‚æœåˆ°è¾¾ç»ˆç‚¹ï¼Œdist å³ä¸ºæœ€çŸ­è·¯å¾„é•¿åº¦
            if r == n - 1 and c == n - 1:
                return dist

            # éå† 8 ä¸ªæ–¹å‘çš„é‚»å±…
            for dr, dc in directions:
                nr = r + dr
                nc = c + dc

                # åˆ¤æ–­æ˜¯å¦åœ¨çŸ©é˜µèŒƒå›´å†…ï¼Œä¸”æ˜¯æœªè®¿é—®çš„å¯èµ°æ ¼å­ï¼ˆå€¼ä¸º 0ï¼‰
                if 0 <= nr < n and 0 <= nc < n and grid[nr][nc] == 0:
                    grid[nr][nc] = 1  # æ ‡è®°ä¸ºå·²è®¿é—®ï¼Œé¿å…é‡å¤å…¥é˜Ÿ
                    queue.append((nr, nc, dist + 1))

        # BFS ç»“æŸä»æœªåˆ°ç»ˆç‚¹ï¼Œè¯´æ˜ä¸å­˜åœ¨è·¯å¾„
        return -1
```

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘ä»¬ä¸‹ä¸€æ­¥å¯ä»¥ç»ƒä¸€é“ç±»ä¼¼çš„ BFS é¢˜ï¼ˆæ¯”å¦‚ã€Œå²›å±¿æ•°é‡ã€æˆ–ã€Œè¿·å®«æœ€çŸ­è·¯å¾„ã€ï¼‰ï¼ŒåŠ æ·±è¿™ä¸ªæ¨¡æ¿çš„è®°å¿†ã€‚

---
## ğŸ¤– Assistant

å¥½çš„ï¼Œæ²¡é—®é¢˜ã€‚ä½œä¸ºä¸€åæœ‰ç»éªŒçš„å·¥ç¨‹å¸ˆï¼Œä½ çš„å¼ºé¡¹åœ¨äºç³»ç»Ÿè®¾è®¡ã€äº§å“æ€ç»´å’Œå·¥ç¨‹å®è·µã€‚ç®—æ³•æ˜¯ä½ çš„çŸ­æ¿ï¼Œä½†ä½ çš„å­¦ä¹ èƒ½åŠ›å’ŒæŠ½è±¡æ€ç»´èƒ½åŠ›è‚¯å®šä¸å·®ã€‚æˆ‘ä»¬ä¸éœ€è¦é’»ç‰›è§’å°–ï¼Œè€Œæ˜¯è¦æŠ“ä½æ ¸å¿ƒæ€æƒ³ï¼Œå½¢æˆä¸€å¥—å¯ä»¥å¿«é€Ÿåº”ç”¨çš„â€œè‚Œè‚‰è®°å¿†â€ã€‚

ä»Šå¤©æˆ‘ä»¬æ¥è®²è§£ **åŠ›æ‰£ 1091. äºŒè¿›åˆ¶çŸ©é˜µä¸­çš„æœ€çŸ­è·¯å¾„**ã€‚è¿™é“é¢˜æ˜¯å›¾è®ºå…¥é—¨çš„ç»å…¸ï¼Œä¹Ÿæ˜¯é¢è¯•ä¸­è€ƒå¯Ÿå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰çš„æœ€é«˜é¢‘é¢˜å‹ä¹‹ä¸€ã€‚

---

### é¢˜ç›®åˆ†æ

ç»™ä½ ä¸€ä¸ª `n x n` çš„äºŒè¿›åˆ¶çŸ©é˜µ `grid`ï¼Œ`0` è¡¨ç¤ºè·¯ï¼Œ`1` è¡¨ç¤ºå¢™ã€‚æˆ‘ä»¬è¦ä»å·¦ä¸Šè§’ `(0, 0)` èµ°åˆ°å³ä¸‹è§’ `(n-1, n-1)`ï¼Œå¯ä»¥èµ° 8 ä¸ªæ–¹å‘ï¼ˆä¸Šã€ä¸‹ã€å·¦ã€å³ã€ä»¥åŠå››ä¸ªæ–œå¯¹è§’ï¼‰ã€‚é—®ä½ æœ€çŸ­çš„è·¯å¾„æœ‰å¤šé•¿ï¼ˆè·¯å¾„é•¿åº¦æŒ‡ç»è¿‡çš„æ ¼å­æ•°ï¼‰ï¼Œå¦‚æœèµ°ä¸é€šï¼Œè¿”å› -1ã€‚

**ç›´è§‚æ„Ÿå—**ï¼šè¿™å°±åƒä¸€ä¸ªè¿·å®«æ¸¸æˆï¼Œæ‰¾ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯çº¿ã€‚

### æ ¸å¿ƒç—›ç‚¹ä¸è§£å†³æ–¹æ¡ˆ

1. **é—®é¢˜ç±»å‹è¯†åˆ«**ï¼šä¸€çœ‹åˆ° **ç½‘æ ¼/çŸ©é˜µ** ä¸­çš„ **æœ€çŸ­è·¯å¾„**ï¼Œä½ çš„è„‘æµ·é‡Œå¿…é¡»ç«‹åˆ»é—ªç°å‡ºä¸¤ä¸ªå­—ï¼š**BFS**ã€‚

2. **ä¸ºä»€ä¹ˆè¦ç”¨ BFS (å¹¿åº¦ä¼˜å…ˆæœç´¢)ï¼Ÿ**
 * **æœ¬è´¨**ï¼šBFS çš„æœç´¢æ–¹å¼å°±åƒå¾€æ°´é‡Œæ‰”ä¸€å—çŸ³å¤´ï¼Œæ³¢çº¹ä¼šä¸€åœˆä¸€åœˆåœ°å‡åŒ€å‘å¤–æ‰©æ•£ã€‚ç¬¬ä¸€åœˆæ˜¯è·ç¦»çŸ³å¤´ä¸º 1 çš„æ‰€æœ‰ç‚¹ï¼Œç¬¬äºŒåœˆæ˜¯è·ç¦»ä¸º 2 çš„æ‰€æœ‰ç‚¹...
 * **ç‰¹æ€§**ï¼šç”±äºå®ƒæ˜¯ä¸€å±‚ä¸€å±‚åœ°å‘å¤–æœç´¢ï¼Œæ‰€ä»¥ **ç¬¬ä¸€æ¬¡** åˆ°è¾¾ç»ˆç‚¹æ—¶ï¼Œèµ°è¿‡çš„è·¯å¾„å¿…ç„¶æ˜¯ **æœ€çŸ­çš„**ã€‚
 * **å¯¹æ¯”**ï¼šå¦‚æœç”¨ DFS (æ·±åº¦ä¼˜å…ˆæœç´¢)ï¼Œå®ƒä¼šä¸€æ¡è·¯èµ°åˆ°é»‘ï¼Œæ‰¾åˆ°çš„è·¯å¾„ä¸ä¸€å®šæ˜¯æœ€çŸ­çš„ã€‚ä½ ä¸ºäº†æ‰¾æœ€çŸ­ï¼Œå°±å¾—éå†æ‰€æœ‰è·¯å¾„ï¼Œæ•ˆç‡æä½ã€‚
 * **ç»“è®º**ï¼šåœ¨ **æ¯ä¸€æ­¥æƒé‡éƒ½ç›¸ç­‰** çš„å›¾ï¼ˆæ¯”å¦‚è¿™é“é¢˜ï¼Œæ¯èµ°ä¸€æ ¼é•¿åº¦éƒ½ç®— 1ï¼‰ä¸­ï¼Œæ±‚æœ€çŸ­è·¯å¾„ï¼Œ**BFS å°±æ˜¯æ ‡å‡†ç­”æ¡ˆ**ã€‚

### é¢è¯•å£è¿°æ€è·¯ (30ç§’ç‰ˆæœ¬)

> â€œé¢è¯•å®˜å¥½ï¼Œè¿™é“é¢˜æœ¬è´¨ä¸Šæ˜¯åœ¨ä¸€ä¸ªç½‘æ ¼å›¾ä¸­å¯»æ‰¾ä¸¤ä¸ªç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ã€‚å› ä¸ºæ¯ä¸€æ­¥çš„æˆæœ¬éƒ½æ˜¯ 1ï¼ˆå³ä»ä¸€ä¸ªæ ¼å­èµ°åˆ°ç›¸é‚»æ ¼å­ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æ— æƒå›¾æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä¼šé€‰æ‹©ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰æ¥è§£å†³ã€‚
>
> æˆ‘çš„æ€è·¯æ˜¯ï¼š
> 1. åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼ŒæŠŠèµ·ç‚¹ `(0,0)` å’Œåˆå§‹è·ç¦» `1` æ”¾è¿›å»ã€‚
> 2. ä½¿ç”¨ä¸€ä¸ª `visited` é›†åˆæˆ–ç›´æ¥ä¿®æ”¹åŸçŸ©é˜µæ¥è®°å½•è®¿é—®è¿‡çš„æ ¼å­ï¼Œé˜²æ­¢èµ°å›å¤´è·¯ã€‚
> 3. ç„¶åè¿›è¡Œå¾ªç¯ï¼Œåªè¦é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå°±å–å‡ºé˜Ÿé¦–å…ƒç´ ï¼Œç„¶åæŠŠå®ƒå‘¨å›´ 8 ä¸ªæ–¹å‘ä¸Šæ‰€æœ‰â€œæ²¡èµ°è¿‡â€ä¸”â€œä¸æ˜¯å¢™â€çš„é‚»å±…æ ¼å­ï¼Œéƒ½åŠ ä¸Š 1 çš„è·ç¦»åï¼Œæ”¾å…¥é˜Ÿå°¾ã€‚
> 4. åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦æˆ‘ä»¬åˆ°è¾¾ç»ˆç‚¹ï¼Œå°±ç«‹åˆ»è¿”å›å½“å‰çš„è·ç¦»ï¼Œå› ä¸º BFS çš„ç‰¹æ€§ä¿è¯äº†è¿™æ˜¯æœ€çŸ­çš„ã€‚å¦‚æœé˜Ÿåˆ—ä¸ºç©ºè¿˜æ²¡åˆ°ç»ˆç‚¹ï¼Œè¯´æ˜è·¯ä¸é€šï¼Œè¿”å› -1ã€‚â€

è¿™ä¸ªå£è¿°æ€è·¯æ¸…æ™°åœ°å±•ç¤ºäº†ä½ å¯¹é—®é¢˜æœ¬è´¨çš„ç†è§£ã€ç®—æ³•çš„é€‰æ‹©å’Œæ ¸å¿ƒæ­¥éª¤ï¼Œéå¸¸ä¸“ä¸šã€‚

### ä»£ç å®ç° (Python)

æˆ‘ä»¬æ¥æŠŠä¸Šé¢çš„æ€è·¯ç¿»è¯‘æˆä»£ç ã€‚

```python
import collections

def shortest_path_binary_matrix(grid: list[list[int]]) -> int:
    """
    è®¡ç®—äºŒè¿›åˆ¶çŸ©é˜µä¸­ä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’çš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚

    Args:
        grid: ä¸€ä¸ª n x n çš„äºŒè¿›åˆ¶çŸ©é˜µï¼Œ0 ä»£è¡¨é€šè·¯ï¼Œ1 ä»£è¡¨éšœç¢ã€‚

    Returns:
        æœ€çŸ­è·¯å¾„çš„é•¿åº¦ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å› -1ã€‚
    """
    # 1. è¾¹ç•Œæƒ…å†µæ£€æŸ¥ï¼šå¦‚æœèµ·ç‚¹æˆ–ç»ˆç‚¹æ˜¯å¢™ï¼Œç›´æ¥è¿”å›-1
    if not grid or grid[0][0] == 1 or grid[-1][-1] == 1:
        return -1

    n = len(grid)
    # å¦‚æœåªæœ‰ä¸€ä¸ªæ ¼å­ä¸”æ˜¯é€šè·¯
    if n == 1:
        return 1

    # 2. åˆå§‹åŒ–é˜Ÿåˆ—å’Œæ–¹å‘
    # é˜Ÿåˆ—ä¸­å­˜å‚¨ (è¡Œ, åˆ—, è·ç¦»)
    queue = collections.deque([(0, 0, 1)])
    
    # å…³é”®ç‚¹ï¼šå°†èµ·ç‚¹æ ‡è®°ä¸ºå·²è®¿é—®ï¼Œé¿å…é‡å¤è®¿é—®ã€‚
    # ç›´æ¥ä¿®æ”¹åŸæ•°ç»„æ¯”ç”¨ä¸€ä¸ªé¢å¤–çš„ set ç©ºé—´æ•ˆç‡æ›´é«˜ã€‚
    grid[0][0] = 1 
    
    # 8ä¸ªå¯èƒ½çš„ç§»åŠ¨æ–¹å‘ (ä¸Š, ä¸‹, å·¦, å³, å’Œå››ä¸ªå¯¹è§’çº¿)
    directions = [(0, 1), (0, -1), (1, 0), (-1, 0),
                  (1, 1), (1, -1), (-1, 1), (-1, -1)]

    # 3. BFS ä¸»å¾ªç¯
    while queue:
        row, col, dist = queue.popleft()

        # éå†8ä¸ªæ–¹å‘
        for dr, dc in directions:
            new_row, new_col = row + dr, col + dc

            # 4. æ£€æŸ¥ä¸‹ä¸€ä¸ªä½ç½®çš„åˆæ³•æ€§
            # a. æ˜¯å¦åœ¨ç½‘æ ¼å†…
            if 0 <= new_row < n and 0 <= new_col < n:
                # b. æ˜¯å¦æ˜¯é€šè·¯ (gridå€¼ä¸º0)
                # c. æ˜¯å¦æœªè¢«è®¿é—®è¿‡
                if grid[new_row][new_col] == 0:
                    # å¦‚æœæ˜¯ç»ˆç‚¹ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æœ€çŸ­è·¯å¾„
                    if new_row == n - 1 and new_col == n - 1:
                        return dist + 1
                    
                    # 5. å°†æ–°ä½ç½®åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶æ ‡è®°ä¸ºå·²è®¿é—®
                    queue.append((new_row, new_col, dist + 1))
                    grid[new_row][new_col] = 1 # æ ‡è®°ä¸ºå·²è®¿é—®

    # 6. å¦‚æœé˜Ÿåˆ—ä¸ºç©ºè¿˜æ²¡æ‰¾åˆ°ç»ˆç‚¹ï¼Œè¯´æ˜è·¯ä¸é€š
    return -1

```

### ä»£ç è®²è§£ä¸é‡ç‚¹

1. **`import collections.deque`**: Python çš„ `list` ç”¨ä½œé˜Ÿåˆ—æ—¶ï¼Œ`pop(0)` çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(N)ï¼Œæ•ˆç‡å¾ˆä½ã€‚`collections.deque` æ˜¯åŒç«¯é˜Ÿåˆ—ï¼Œ`popleft()` çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)ï¼Œæ˜¯å®ç° BFS çš„æ ‡å‡†å·¥å…·ã€‚
2. **`if grid[^0][^0] == 1 ...`**: å…ˆå¤„ç†è¿™äº›æœ€ç®€å•çš„ç‰¹æ®Šæƒ…å†µï¼Œæ˜¯ä¸ªå¥½ä¹ æƒ¯ã€‚
3. **`queue = collections.deque([(0, 0, 1)])`**: é˜Ÿåˆ—é‡Œå­˜çš„æ˜¯å…ƒç»„ `(è¡Œ, åˆ—, åˆ°å½“å‰æ ¼å­çš„è·ç¦»)`ã€‚èµ·ç‚¹è·ç¦»æ˜¯ 1ã€‚
4. **`grid[^0][^0] = 1`**: è¿™æ˜¯ä¸ªéå¸¸é‡è¦çš„ä¼˜åŒ–ã€‚ä¸ºäº†é˜²æ­¢èµ°å›å¤´è·¯æˆ–è€…åœ¨åœˆé‡Œæ‰“è½¬ï¼Œå¿…é¡»è®°å½•å“ªäº›æ ¼å­å·²ç»èµ°è¿‡äº†ã€‚æœ€èŠ‚çœç©ºé—´çš„æ–¹æ³•å°±æ˜¯ç›´æ¥ä¿®æ”¹åŸ `grid`ï¼ŒæŠŠèµ°è¿‡çš„ `0` æ”¹æˆ `1`ï¼ˆæˆ–è€…å…¶ä»–é 0 å€¼ï¼‰ï¼Œè¿™æ ·å®ƒå°±è‡ªç„¶å˜æˆäº†â€œå¢™â€ï¼Œä¸ä¼šå†è¢«è®¿é—®äº†ã€‚
5. **`while queue:`**: è¿™æ˜¯ BFS ç®—æ³•çš„æ ¸å¿ƒæ¡†æ¶ï¼Œåªè¦é˜Ÿåˆ—é‡Œè¿˜æœ‰å¾…æ¢ç´¢çš„æ ¼å­ï¼Œå°±ç»§ç»­å¾ªç¯ã€‚
6. **`queue.popleft()`**: ä»é˜Ÿåˆ—å¤´éƒ¨å–å‡ºæœ€å…ˆæ”¾è¿›å»çš„å…ƒç´ ï¼Œä½“ç°äº†â€œå…ˆè¿›å…ˆå‡ºâ€å’Œâ€œä¸€å±‚ä¸€å±‚â€çš„åŸåˆ™ã€‚
7. **`for dr, dc in directions:`**: å¾ªç¯éå† 8 ä¸ªæ–¹å‘ï¼Œä»£ç æ¯”å†™ 8 ä¸ª `if` åˆ¤æ–­è¦ç®€æ´ä¼˜é›…å¾—å¤šã€‚
8. **`if new_row == n - 1 and new_col == n - 1:`**: åœ¨å°†é‚»å±…èŠ‚ç‚¹å…¥é˜Ÿ **ä¹‹å‰** æ£€æŸ¥å®ƒæ˜¯å¦æ˜¯ç»ˆç‚¹ã€‚å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆ `å½“å‰è·ç¦» + 1` å°±æ˜¯æœ€ç»ˆç­”æ¡ˆã€‚
9. **`queue.append(...)` å’Œ `grid[new_row][new_col] = 1`**: è¿™ä¸¤æ­¥æ˜¯ç»‘å®šçš„ã€‚ä¸€æ—¦å†³å®šä¸€ä¸ªæ ¼å­æ˜¯ä¸‹ä¸€æ­¥è¦èµ°çš„ï¼Œå°±ç«‹åˆ»æŠŠå®ƒåŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶ **é©¬ä¸Šæ ‡è®°ä¸ºå·²è®¿é—®**ã€‚ä¸è¦ç­‰åˆ°ä»é˜Ÿåˆ—é‡Œå–å‡ºæ¥çš„æ—¶å€™å†æ ‡è®°ï¼Œé‚£æ ·å¯èƒ½ä¼šå¯¼è‡´åŒä¸€ä¸ªæ ¼å­è¢«é‡å¤æ”¾å…¥é˜Ÿåˆ—ã€‚

### æ€»ç»“

å¯¹äºä½ ç›®å‰çš„æƒ…å†µï¼ŒæŒæ¡è¿™é“é¢˜çš„å…³é”®åœ¨äºï¼š

1. **å½¢æˆæ¡ä»¶åå°„**ï¼š`ç½‘æ ¼/å›¾` + `æœ€çŸ­è·¯å¾„` => `BFS`ã€‚
2. **è®°ä½ BFS æ¨¡æ¿**ï¼š`é˜Ÿåˆ—(queue)` + `å·²è®¿é—®é›†åˆ(visited)` + `whileå¾ªç¯` + `foré‚»å±…`ã€‚
3. **ç†è§£æ ¸å¿ƒ**ï¼šBFS ä¿è¯äº†ç¬¬ä¸€æ¬¡åˆ°è¾¾å³æœ€çŸ­ã€‚

è¿™é“é¢˜çš„æ¨¡æ¿å¯ä»¥è§£å†³ä¸€å¤§ç±»ç±»ä¼¼çš„é¢˜ç›®ã€‚æŠŠå®ƒç†è§£é€å½»ï¼Œä½ çš„ç®—æ³•æ°´å¹³å°±èƒ½ç¨³ç¨³åœ°ä»ä¸‰å››ååˆ†æå‡åˆ°äº”å…­ååˆ†ã€‚åŠ æ²¹ï¼

---
## ğŸ§‘â€ğŸ’» User

ä¸‹é¢æˆ‘çš„ä»£ç å“ªé‡Œæœ‰é—®é¢˜ï¼Ÿ
class Solution:
 def shortestPathBinaryMatrix(self, grid: List[List[int]]) -> int:
 n = len(grid)
 if grid[^0][^0] == 1 or grid[n-1][n-1] == 1:
 return -1
 if n == 1:
 return 1
 dq = collections.deque([(0, 0, 1)])
 directions = [
 [-1, -1], [-1, 0], [-1, 1],
 [0, -1], [0, 1],
 [1, -1], [1, 0], [1, 1]
 ]
 grid[^0][^0] = 1
 while dq:
 curr_r, curr_c, dist = dq.popleft()
 if curr_r == n-1 and curr_c == n-1:
 return dist
 for dr, dc in directions:
 nr, nc = curr_r + dr, curr_c + dc
 if 0 <= nr < n-1 and 0 <= nc < n-1 and grid[nr][nc] == 0:
 grid[nr][nc] = 1
 dq.append((nr, nc, dist + 1))
 return -1

---
## ğŸ¤– Assistant

ä¸»è¦é—®é¢˜åœ¨è¿™ä¸€è¡Œçš„è¾¹ç•Œåˆ¤æ–­ï¼š

```python
if 0 <= nr < n-1 and 0 <= nc < n-1 and grid[nr][nc] == 0:
```

ä½ å†™æˆäº† `< n-1`ï¼Œè¿™æ ·ä¼šå¯¼è‡´ï¼š

- è¡Œ/åˆ—ç´¢å¼•åªå…è®¸åˆ° `0 ~ n-2`
- **æ°¸è¿œä¸ä¼šè®¿é—®æœ€åä¸€è¡Œå’Œæœ€åä¸€åˆ—**
- ç»“æœï¼šå³ä½¿ç»ˆç‚¹ `(n-1, n-1)` å¯è¾¾ï¼Œä¹Ÿä¸ä¼šè¢«åŠ å…¥é˜Ÿåˆ—ï¼Œè‡ªç„¶å°±è¿”å›äº† `-1`

ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š

```text
grid = [
  [0, 0],
  [0, 0]
]
n = 2
```

- åˆæ³•ç´¢å¼•åº”è¯¥æ˜¯ `0` å’Œ `1`
- ä½†ä½ å†™ `0 <= nr < n-1` ç­‰ä»·äº `0 <= nr < 1`ï¼Œä¹Ÿå°±æ˜¯åªå…è®¸ `nr == 0`
- æ•´ä¸ªç¬¬äºŒè¡Œï¼ˆç´¢å¼• 1ï¼‰å’Œç¬¬äºŒåˆ—éƒ½ä¸ä¼šè¢«è®¿é—®åˆ°

æ­£ç¡®å†™æ³•åº”è¯¥æ˜¯ `< n`ï¼š

```python
if 0 <= nr < n and 0 <= nc < n and grid[nr][nc] == 0:
```

---

å¦å¤–ä¸¤ä¸ªå°ç‚¹ï¼ˆä¸æ˜¯è‡´å‘½é”™è¯¯ï¼Œä½†å»ºè®®æ”¹ä¸€ä¸‹ï¼‰ï¼š

1. éœ€è¦å¯¼å…¥ä¾èµ–ï¼š
```python
   from typing import List
   import collections
   ```
2. `directions` ç”¨åˆ—è¡¨/å…ƒç»„éƒ½å¯ä»¥ï¼Œç°åœ¨è¿™æ ·æ²¡é—®é¢˜ã€‚

---

ä¿®æ­£åçš„ä»£ç å¦‚ä¸‹ï¼ˆåªæ”¹äº†è¾¹ç•Œåˆ¤æ–­å’Œè¡¥äº† importï¼‰ï¼š

```python
from typing import List
import collections


class Solution:
 def shortestPathBinaryMatrix(self, grid: List[List[int]]) -> int:
 n = len(grid)
 # èµ·ç‚¹æˆ–ç»ˆç‚¹æ˜¯éšœç¢ï¼Œç›´æ¥æ— è§£
 if grid[^0][^0] == 1 or grid[n - 1][n - 1] == 1:
 return -1
 # ç‰¹æ®Šæƒ…å†µï¼š1x1 ä¸”å¯èµ°
 if n == 1:
 return 1

 dq = collections.deque([(0, 0, 1)])
 directions = [
 [-1, -1], [-1, 0], [-1, 1],
 [0, -1], [0, 1],
 [1, -1], [1, 0], [1, 1],
 ]
 grid[^0][^0] = 1 # æ ‡è®°èµ·ç‚¹å·²è®¿é—®

 while dq:
 curr_r, curr_c, dist = dq.popleft()
 if curr_r == n - 1 and curr_c == n - 1:
 return dist
 for dr, dc in directions:
 nr, nc = curr_r + dr, curr_c + dc
 # è¿™é‡Œè¦å†™ < nï¼Œè€Œä¸æ˜¯ < n-1
 if 0 <= nr < n and 0 <= nc < n and grid[nr][nc] == 0:
 grid[nr][nc] = 1
 dq.append((nr, nc, dist + 1))
 return -1
```

**é¢è¯•å¯è¯´çš„è¦ç‚¹ï¼ˆ10 ç§’çº§ï¼‰**ï¼š

> ä»£ç é‡Œæˆ‘ä¸€å¼€å§‹æŠŠè¾¹ç•Œå†™æˆ `< n-1`ï¼Œå¯¼è‡´æ°¸è¿œè®¿é—®ä¸åˆ°æœ€åä¸€è¡Œå’Œæœ€åä¸€åˆ—ï¼Œç»ˆç‚¹ä¹Ÿå°±å…¥ä¸äº†é˜Ÿã€‚BFS é‡Œåˆ¤æ–­åæ ‡æ˜¯å¦åœ¨çŸ©é˜µå†…å¿…é¡»ç”¨ `0 <= r < n` / `0 <= c < n`ã€‚
