# æ»‘åŠ¨è°œé¢˜BFSè§£é¢˜æ€è·¯

## ğŸ§‘â€ğŸ’» User

è®²è§£åŠ›æ‰£é¢˜ç›®773. æ»‘åŠ¨è°œé¢˜

---
## ğŸ¤– Assistant

### 1. é¢˜ç›®æœ¬è´¨ï¼šæœ€çŸ­æ­¥æ•° -> BFS æ‰¾çŠ¶æ€æœ€çŸ­è·¯å¾„

é¢˜æ„ç®€åŒ–ä¸€ä¸‹ï¼š

- åªæœ‰ä¸€ä¸ª 2x3 çš„å°æ£‹ç›˜
```
  a b c
  d e f
  ```
- é‡Œé¢æœ‰æ•°å­— 0~5ï¼Œ0è¡¨ç¤ºç©ºæ ¼ï¼Œå¯ä»¥å’Œå®ƒä¸Šä¸‹å·¦å³ç›¸é‚»çš„æ•°å­—äº¤æ¢ä½ç½®ã€‚
- ç›®æ ‡æ˜¯æŠŠå½“å‰å±€é¢å˜æˆï¼š  
  `[[1,2,3],[4,5,0]]`ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸² `"123450"`ã€‚
- é—®ï¼šæœ€å°‘éœ€è¦å¤šå°‘æ­¥ï¼Ÿå¦‚æœæ°¸è¿œåˆ°ä¸äº†ï¼Œè¿”å› -1ã€‚

**æœ¬è´¨ï¼š**  
è¿™æ˜¯ä¸€ä¸ªå¾ˆå…¸å‹çš„ã€ŒçŠ¶æ€æœ€çŸ­æ­¥æ•°ã€é—®é¢˜ï¼Œæœ¬è´¨æ˜¯ï¼š

> åœ¨ã€Œæ‰€æœ‰å¯èƒ½æ£‹ç›˜çŠ¶æ€ã€æ„æˆçš„å›¾é‡Œé¢ï¼Œæ±‚ä»èµ·å§‹çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€çš„**æœ€çŸ­è·¯å¾„é•¿åº¦**ï¼Œæ¯ä¸€æ­¥æ˜¯ä¸€æ¬¡åˆæ³•ç§»åŠ¨ã€‚

å›¾æ˜¯**æ— æƒå›¾**ï¼ˆæ¯ä¸€æ­¥ä»£ä»·éƒ½ä¸€æ ·ï¼‰ï¼Œæ±‚æœ€çŸ­æ­¥æ•° => **BFSï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰** æ˜¯æ ‡å‡†è§£æ³•ã€‚

---

### 2. ä¸ºä»€ä¹ˆç”¨ BFSï¼Œè€Œä¸æ˜¯ DFS / å›æº¯ / è´ªå¿ƒï¼Ÿ

- æ¯ä¸€æ­¥ç§»åŠ¨çš„ä»£ä»·ç›¸åŒï¼Œæ‰€ä»¥ã€Œæ­¥æ•°æœ€å°‘ã€=ã€Œè¾¹æ•°æœ€å°‘ã€ã€‚
- æ— æƒå›¾æ±‚ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€å°‘è¾¹æ•° -> BFS çš„ç»å…¸ç”¨é€”ã€‚
- DFS / å›æº¯åªä¼šæ‰¾åˆ°ä¸€æ¡è·¯å¾„ï¼Œä¸ä¿è¯æ˜¯æœ€çŸ­çš„ï¼›è¿˜å¯èƒ½çˆ†æœå¾ˆå¤šæ²¡ç”¨è·¯å¾„ã€‚
- è¿™ä¸ªé—®é¢˜çŠ¶æ€ç©ºé—´å¾ˆå°ï¼š
  - 2x3 æ£‹ç›˜ä¸Š 6 ä¸ªä½ç½®ï¼Œæ”¾ 0~5 -> æœ€å¤š 6! = 720 ç§çŠ¶æ€ã€‚
  - ç”¨ BFS æŠŠæ‰€æœ‰çŠ¶æ€éƒ½æœä¸€éä¹Ÿå¾ˆè½»æ¾ã€‚

**ç»“è®ºï¼š**  
ç¡®å®šæ— æƒä¸”çŠ¶æ€ç©ºé—´å° -> ç›´æ¥ BFSï¼Œæ˜¯æ­£ç¡®ä¸”è¶³å¤Ÿé«˜æ•ˆçš„æ–¹æ¡ˆã€‚

---

### 3. å…³é”®è®¾è®¡ï¼šå¦‚ä½•æŠŠæ£‹ç›˜å˜æˆã€Œå›¾ä¸Šçš„ç‚¹ã€ï¼Ÿ

#### 3.1 çŠ¶æ€è¡¨ç¤º

æŠŠ 2x3 æ£‹ç›˜ flattenï¼ˆæ‹‰å¹³ï¼‰æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ï¼š

```text
[ [1, 2, 3],
[4, 0, 5] ]

-> "123405"
```

ç›®æ ‡çŠ¶æ€æ˜¯å›ºå®šçš„ `"123450"`ã€‚

è¿™æ ·ï¼š

- æ¯ä¸€ä¸ªå­—ç¬¦ä¸² = ä¸€ç§æ£‹ç›˜çŠ¶æ€ = å›¾ä¸Šçš„ä¸€ä¸ªç‚¹ã€‚
- æ¯ä¸€æ­¥ç§»åŠ¨ç©ºæ ¼ï¼ˆ0ï¼‰å’ŒæŸä¸ªç›¸é‚»æ•°å­—äº¤æ¢ï¼Œå°±æ˜¯ã€Œä»ä¸€ä¸ªç‚¹è¿åˆ°å¦ä¸€ä¸ªç‚¹çš„è¾¹ã€ã€‚

#### 3.2 é¢„å…ˆå†™å¥½ã€Œç©ºæ ¼å¯ä»¥å¾€å“ªå„¿èµ°ã€

æŠŠ 2x3 æ£‹ç›˜ç¼–å·æˆä¸€ç»´ç´¢å¼•ï¼š

```text
ç´¢å¼•: 0 1 2
 3 4 5
```

æ¯ä¸ªä½ç½®å¯ä»¥è·Ÿè°äº¤æ¢ï¼ˆä¸Š/ä¸‹/å·¦/å³é‚»å±…ï¼‰æ˜¯å›ºå®šçš„ï¼Œæå‰å†™æ­»ä¸€ä¸ªé‚»æ¥è¡¨ï¼š

```text
0: [1, 3]
1: [0, 2, 4]
2: [1, 5]
3: [0, 4]
4: [1, 3, 5]
5: [2, 4]
```

æˆ‘ä»¬åªéœ€è¦ï¼š

1. æ‰¾åˆ°å½“å‰çŠ¶æ€å­—ç¬¦ä¸²é‡Œ `'0'` çš„ä½ç½® idxã€‚
2. æŸ¥è¡¨ neighbors[idx]ï¼Œå¾—åˆ°æ‰€æœ‰å¯ä»¥äº¤æ¢çš„ä½ç½® next_idxã€‚
3. ç”Ÿæˆæ–°å­—ç¬¦ä¸²ï¼šæŠŠ idx å’Œ next_idx çš„å­—ç¬¦äº¤æ¢å³å¯ã€‚

#### 3.3 BFS ç»“æ„

å…¸å‹å†™æ³•ï¼š

- é˜Ÿåˆ—é‡Œæ”¾ï¼š`(çŠ¶æ€å­—ç¬¦ä¸², å½“å‰æ­¥æ•°)`
- ä¸€ä¸ª `visited` é›†åˆï¼Œé¿å…é‡å¤çŠ¶æ€æ­»å¾ªç¯ã€‚
- æ­¥éª¤ï¼š
  1. åˆå§‹çŠ¶æ€å…¥é˜Ÿï¼Œæ­¥æ•°=0ï¼Œæ ‡è®° visitedã€‚
  2. æ¯æ¬¡ä»é˜Ÿåˆ—å¼¹å‡ºä¸€ä¸ªçŠ¶æ€ï¼š
     - å¦‚æœå·²ç»æ˜¯ç›®æ ‡ `"123450"`ï¼Œç›´æ¥è¿”å›å½“å‰æ­¥æ•°ã€‚
     - å¦åˆ™ï¼Œæ ¹æ® 0 çš„é‚»å±…ç”Ÿæˆæ‰€æœ‰ä¸‹ä¸€æ­¥çŠ¶æ€ï¼š
       - æ²¡è®¿é—®è¿‡ -> å…¥é˜Ÿï¼Œæ­¥æ•°+1ã€‚
  3. é˜Ÿåˆ—ç©ºäº†éƒ½æ²¡æ‰¾åˆ°ç›®æ ‡ -> è¿”å› -1ã€‚

---

### 4. ä»£ç å®ç°ï¼ˆPythonï¼Œå¸¦ä¸­æ–‡æ³¨é‡Šï¼‰

```python
from collections import deque
from typing import List


class Solution:
 def slidingPuzzle(self, board: List[List[int]]) -> int:
 """æ±‚2x3æ»‘åŠ¨æ‹¼å›¾æœ€å°‘æ­¥æ•°ã€‚

 ä½¿ç”¨ BFS åœ¨çŠ¶æ€ç©ºé—´ä¸­å¯»æ‰¾ä»èµ·å§‹çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€ "123450" çš„æœ€çŸ­æ­¥æ•°ã€‚

 Args:
 board: 2x3 çš„æ£‹ç›˜ï¼Œ0 è¡¨ç¤ºç©ºæ ¼ã€‚

 Returns:
 æœ€å°‘æ­¥æ•°ï¼›å¦‚æœæ— æ³•åˆ°è¾¾ç›®æ ‡çŠ¶æ€åˆ™è¿”å› -1ã€‚
 """
 # 1. å°†äºŒç»´æ£‹ç›˜è½¬ä¸ºä¸€ç»´å­—ç¬¦ä¸²çŠ¶æ€ï¼Œä¾‹å¦‚ [[1,2,3],[4,0,5]] -> "123405"
 start = ''.join(str(num) for row in board for num in row)
 target = '123450'

 # å¦‚æœä¸€å¼€å§‹å°±æ˜¯ç›®æ ‡çŠ¶æ€ï¼Œç›´æ¥è¿”å› 0
 if start == target:
 return 0

 # 2. é¢„å…ˆå®šä¹‰ç©ºæ ¼(0)åœ¨æ¯ä¸ªç´¢å¼•ä½ç½®æ—¶ï¼Œèƒ½å’Œå“ªäº›ç´¢å¼•ä½ç½®äº¤æ¢ï¼ˆé‚»å±…ï¼‰
 # æ£‹ç›˜ç´¢å¼•å¸ƒå±€ï¼š
 # 0 1 2
 # 3 4 5
 neighbors = [
 [1, 3], # 0 å¯ä»¥å’Œ 1,3 äº¤æ¢
 [0, 2, 4], # 1 å¯ä»¥å’Œ 0,2,4 äº¤æ¢
 [1, 5], # 2 å¯ä»¥å’Œ 1,5 äº¤æ¢
 [0, 4], # 3 å¯ä»¥å’Œ 0,4 äº¤æ¢
 [1, 3, 5], # 4 å¯ä»¥å’Œ 1,3,5 äº¤æ¢
 [2, 4], # 5 å¯ä»¥å’Œ 2,4 äº¤æ¢
 ]

 # 3. BFS é˜Ÿåˆ—ä¸ visited é›†åˆ
 queue = deque()
 queue.append((start, 0)) # (å½“å‰çŠ¶æ€å­—ç¬¦ä¸², å·²ç”¨æ­¥æ•°)
 visited = {start}

 # 4. å¼€å§‹ BFS
 while queue:
 state, steps = queue.popleft()
 zero_idx = state.index('0') # å½“å‰çŠ¶æ€ä¸­ç©ºæ ¼çš„ä½ç½®ç´¢å¼•

 # éå†æ‰€æœ‰å¯ä»¥å’Œ 0 äº¤æ¢çš„ä½ç½®
 for next_idx in neighbors[zero_idx]:
 # å°†å­—ç¬¦ä¸²è½¬æˆåˆ—è¡¨ï¼Œæ–¹ä¾¿äº¤æ¢å­—ç¬¦
 state_list = list(state)
 # äº¤æ¢ 0 å’Œç›¸é‚»å…ƒç´ çš„ä½ç½®
 state_list[zero_idx], state_list[next_idx] = (
 state_list[next_idx], state_list[zero_idx]
 )
 new_state = ''.join(state_list)

 # å¦‚æœæ–°çŠ¶æ€å·²ç»æ˜¯ç›®æ ‡ï¼Œè¿”å›æ­¥æ•°+1
 if new_state == target:
 return steps + 1

 # å¦‚æœæ–°çŠ¶æ€æ²¡è®¿é—®è¿‡ï¼ŒåŠ å…¥é˜Ÿåˆ—
 if new_state not in visited:
 visited.add(new_state)
 queue.append((new_state, steps + 1))

 # 5. BFS ç»“æŸä¹Ÿæ²¡æ‰¾åˆ°ç›®æ ‡ï¼Œè¯´æ˜æ— æ³•åˆ°è¾¾
 return -1
```

---

### 5. å¤æ‚åº¦ & é¢è¯•å¯è¯´ç‚¹

**æ—¶é—´å¤æ‚åº¦ï¼š**

- æœ€å¤šçŠ¶æ€æ•°ä¸º 6! = 720ï¼Œè¾¹æ•°æ˜¯å¸¸æ•°çº§ï¼Œ
- BFS éå†æ‰€æœ‰çŠ¶æ€ä¸€æ¬¡ï¼Œå¤æ‚åº¦å¯ä»¥è®¤ä¸ºæ˜¯ O(1)ï¼ˆå¸¸æ•°ä¸Šé™ï¼‰ã€‚
- æ›´è§„èŒƒè¯´æ³•ï¼šO(V + E)ï¼Œè¿™é‡Œ V, E éƒ½æ˜¯æœ‰é™å¸¸æ•°ã€‚

**ç©ºé—´å¤æ‚åº¦ï¼š**

- visited å­˜æ‰€æœ‰çŠ¶æ€ï¼Œæœ€å¤š 720 ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿæ˜¯å¸¸æ•°çº§ï¼Œå¯è®¤ä¸º O(1)ã€‚

---

### 6. é¢è¯•ä¸­ 30 ç§’å†…çš„å£è¿°æ€è·¯ï¼ˆä½ å¯ä»¥èƒŒä¸€ä¸‹ï¼‰

> è¿™æ˜¯ä¸€ä¸ªåœ¨çŠ¶æ€ç©ºé—´ä¸Šæ±‚æœ€çŸ­æ­¥æ•°çš„é—®é¢˜ï¼Œæˆ‘ç”¨ BFS åšã€‚
> é¦–å…ˆæŠŠ 2x3 æ£‹ç›˜æ‹‰å¹³æˆå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ "123405"ï¼Œç›®æ ‡æ˜¯ "123450"ã€‚
> æŠŠæ‰€æœ‰å¯èƒ½çš„æ£‹ç›˜çŠ¶æ€çœ‹æˆå›¾ä¸Šçš„ç‚¹ï¼Œæ¯æ¬¡ç§»åŠ¨ 0 å’Œå®ƒä¸Šä¸‹å·¦å³ç›¸é‚»çš„æ•°äº¤æ¢ï¼Œå°±æ˜¯åœ¨å›¾é‡Œèµ°ä¸€æ¡è¾¹ã€‚
> å› ä¸ºæ¯æ­¥ä»£ä»·ç›¸åŒï¼Œæ‰€ä»¥ç”¨ BFS ä»èµ·å§‹çŠ¶æ€å¼€å§‹æœç´¢ï¼Œç¬¬ä¸€æ¬¡åˆ°è¾¾ç›®æ ‡çŠ¶æ€æ—¶çš„å±‚æ•°ï¼Œå°±æ˜¯æœ€å°‘æ­¥æ•°ã€‚
> å®ç°ä¸Šï¼Œæˆ‘é¢„å…ˆå†™å¥½ 2x3 æ£‹ç›˜ä¸Šæ¯ä¸ªç´¢å¼•çš„é‚»å±…åˆ—è¡¨ï¼Œç”¨é˜Ÿåˆ—åš BFSï¼Œé…åˆ visited é›†åˆé¿å…é‡å¤çŠ¶æ€ã€‚å¦‚æœ BFS ç»“æŸè¿˜æ²¡é‡åˆ°ç›®æ ‡ï¼Œå°±è¿”å› -1ã€‚
> è¿™ä¸ªé—®é¢˜çš„çŠ¶æ€æœ€å¤šåªæœ‰ 6! ç§ï¼Œæ‰€ä»¥ BFS åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½å®Œå…¨å¯è¡Œã€‚

---
## ğŸ¤– Assistant

å¥½çš„ï¼Œæ²¡é—®é¢˜ï¼ä½œä¸ºä¸€åç»éªŒä¸°å¯Œçš„å·¥ç¨‹å¸ˆï¼Œä½ çš„ä¼˜åŠ¿åœ¨äºå¼ºå¤§çš„å·¥ç¨‹èƒ½åŠ›å’Œé€»è¾‘æ€ç»´ã€‚æˆ‘ä»¬è¦åšçš„æ˜¯æŠŠè¿™ç§èƒ½åŠ›å¿«é€Ÿè¿ç§»åˆ°ç®—æ³•é¢˜ä¸Šï¼Œè€Œä¸æ˜¯ä»é›¶å¼€å§‹å­¦ç†è®ºã€‚

å¯¹äºæ•°æ®ç»“æ„å’Œç®—æ³•è–„å¼±çš„åŒå­¦ï¼Œ**å¹¿åº¦ä¼˜å…ˆæœç´¢ (BFS)** æ˜¯ä¸€ä¸ªå¿…é¡»æŒæ¡ä¸”æ€§ä»·æ¯”æé«˜çš„ç®—æ³•ï¼Œå› ä¸ºå®ƒèƒ½è§£å†³æ‰€æœ‰â€œæœ€çŸ­è·¯å¾„â€æˆ–â€œæœ€å°‘æ­¥æ•°â€é—®é¢˜ã€‚è¿™é“ã€Œæ»‘åŠ¨è°œé¢˜ã€å°±æ˜¯å…¸å‹çš„ BFS åº”ç”¨åœºæ™¯ã€‚

---

### LeetCode 773. æ»‘åŠ¨è°œé¢˜

#### 1. ç›´å‡»æœ¬è´¨ï¼šä¸ºä»€ä¹ˆè¦ç”¨ BFSï¼Ÿ

å¿˜æ‰å¤æ‚çš„ç†è®ºï¼Œè®°ä½æœ€æ ¸å¿ƒçš„ä¸€ç‚¹ï¼š

* **é¢˜ç›®é—®â€œæœ€å°‘â€å¤šå°‘æ­¥ï¼Ÿ -> é©¬ä¸Šæƒ³åˆ°å¹¿åº¦ä¼˜å…ˆæœç´¢ (BFS)ã€‚**

ä¸ºä»€ä¹ˆï¼Ÿæƒ³è±¡ä¸€ä¸‹ä½ åœ¨ä¸€ä¸ªè¿·å®«é‡Œæ‰¾å‡ºå£ï¼ŒBFS å°±åƒä½ ä»èµ·ç‚¹å¼€å§‹ï¼Œå…ˆæŠŠæ‰€æœ‰ä¸€æ­¥èƒ½èµ°åˆ°çš„æˆ¿é—´éƒ½æ¢ç´¢ä¸€éï¼Œå†æŠŠæ‰€æœ‰ä¸¤æ­¥èƒ½èµ°åˆ°çš„æˆ¿é—´æ¢ç´¢ä¸€é... è¿™æ ·å±‚å±‚å‘å¤–æ‰©å±•ã€‚æ‰€ä»¥ï¼Œå½“ä½ ç¬¬ä¸€æ¬¡æ‰¾åˆ°å‡ºå£æ—¶ï¼Œèµ°çš„æ­¥æ•°ä¸€å®šæ˜¯æœ€å°‘çš„ã€‚

è¿™é“é¢˜å°±æ˜¯ä¸ªè¿·å®«ï¼š
* **è¿·å®«çš„æ¯ä¸ªâ€œä½ç½®â€**ï¼šå°±æ˜¯è°œé¢˜æ¿çš„ä¸€ç§æ’åˆ—çŠ¶æ€ï¼Œæ¯”å¦‚ `[[1,2,3],[4,5,0]]`ã€‚
* **ä»ä¸€ä¸ªä½ç½®èµ°åˆ°å¦ä¸€ä¸ªä½ç½®çš„â€œè·¯â€**ï¼šå°±æ˜¯æ»‘åŠ¨ä¸€æ¬¡ `0`ã€‚
* **èµ·ç‚¹**ï¼šå°±æ˜¯é¢˜ç›®ç»™çš„åˆå§‹çŠ¶æ€ã€‚
* **ç»ˆç‚¹**ï¼šå°±æ˜¯ `[[1,2,3],[4,5,0]]` è¿™ä¸ªç›®æ ‡çŠ¶æ€ã€‚
* **ç›®æ ‡**ï¼šæ‰¾åˆ°ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚

æ‰€ä»¥ï¼Œè¿™é“é¢˜è¢«æˆ‘ä»¬æˆåŠŸåœ°è½¬åŒ–æˆäº†ä¸€ä¸ª BFS çš„æ¨¡æ¿é¢˜ã€‚

#### 2. é€šä¿—è®²è§£ï¼šBFS å¦‚ä½•è§£å†³è¿™é“é¢˜ï¼Ÿ

æˆ‘ä»¬çš„æ ¸å¿ƒæ€è·¯æ˜¯æ¨¡æ‹Ÿè¿™ä¸ªâ€œå±‚å±‚æ‰©å±•â€çš„è¿‡ç¨‹ã€‚éœ€è¦ä¸‰ä¸ªå·¥å…·ï¼š

1. **ä¸€ä¸ªé˜Ÿåˆ— (Queue)**ï¼šç”¨æ¥å­˜æ”¾â€œå¾…å¤„ç†â€çš„è°œé¢˜çŠ¶æ€ã€‚å°±åƒä¸€ä¸ªä»»åŠ¡æ¸…å•ï¼Œæˆ‘ä»¬æŒ‰é¡ºåºå¤„ç†ã€‚
2. **ä¸€ä¸ªé›†åˆ (Set)**ï¼šç”¨æ¥è®°å½•â€œå·²ç»å¤„ç†è¿‡â€çš„çŠ¶æ€ã€‚é˜²æ­¢æˆ‘ä»¬èµ°å›å¤´è·¯ï¼Œé™·å…¥æ­»å¾ªç¯ï¼ˆæ¯”å¦‚æŠŠ 0 å‘å³æ»‘ï¼Œå†å‘å·¦æ»‘å›æ¥ï¼‰ã€‚
3. **çŠ¶æ€è¡¨ç¤º**ï¼š`[[1,2,3],[4,0,5]]` è¿™æ ·çš„äºŒç»´åˆ—è¡¨ï¼Œæ²¡æ³•ç›´æ¥å­˜æ”¾åˆ°é›†åˆé‡Œã€‚æˆ‘ä»¬éœ€è¦æŠŠå®ƒâ€œå‹å¹³â€æˆä¸€ä¸ªä¸å¯å˜çš„ã€èƒ½ä½œä¸ºå”¯ä¸€æ ‡è¯†çš„ä¸œè¥¿ï¼Œæ¯”å¦‚å­—ç¬¦ä¸² `"123405"` æˆ–è€…å…ƒç»„ `(1,2,3,4,0,5)`ã€‚å­—ç¬¦ä¸²åœ¨è¿™é‡Œæ›´æ–¹ä¾¿æ“ä½œã€‚

**æ­¥éª¤å¦‚ä¸‹ï¼š**

1. **åˆå§‹åŒ–**ï¼š
 * æŠŠåˆå§‹çŠ¶æ€ï¼ˆæ¯”å¦‚ `[[4,1,2],[5,0,3]]`ï¼‰è½¬æ¢æˆå­—ç¬¦ä¸² `"412503"`ã€‚
 * æŠŠè¿™ä¸ªå­—ç¬¦ä¸²å’Œåˆå§‹æ­¥æ•° `0` ä¸€èµ·æ”¾è¿›é˜Ÿåˆ—ã€‚
 * æŠŠè¿™ä¸ªå­—ç¬¦ä¸²ä¹Ÿæ”¾è¿›â€œå·²è®¿é—®â€é›†åˆã€‚

2. **å¼€å§‹å¾ªç¯ (åªè¦é˜Ÿåˆ—ä¸ç©º)**ï¼š
 * ä»é˜Ÿåˆ—é‡Œå–å‡ºä¸€ä¸ªçŠ¶æ€ï¼Œæ¯”å¦‚ `"412503"`ï¼Œå’Œå®ƒå¯¹åº”çš„æ­¥æ•° `k`ã€‚
 * **åˆ¤æ–­**ï¼šè¿™ä¸ªçŠ¶æ€æ˜¯ä¸æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ `"123450"`ï¼Ÿ
 * å¦‚æœæ˜¯ï¼Œå¤ªæ£’äº†ï¼æˆ‘ä»¬æ‰¾åˆ°äº†æœ€çŸ­è·¯å¾„ï¼Œç›´æ¥è¿”å›æ­¥æ•° `k`ã€‚
 * å¦‚æœä¸æ˜¯ï¼Œç»§ç»­å¾€ä¸‹ã€‚
 * **å¯»æ‰¾ä¸‹ä¸€æ­¥**ï¼šæ‰¾åˆ°å½“å‰çŠ¶æ€ä¸­ `0` çš„ä½ç½®ï¼Œçœ‹çœ‹å®ƒå¯ä»¥å’Œå“ªäº›æ•°å­—äº¤æ¢ï¼Œä»è€Œäº§ç”Ÿæ–°çš„çŠ¶æ€ã€‚
 * ä¾‹å¦‚ï¼Œåœ¨ `"412503"` ä¸­ï¼Œ`0` åœ¨ç´¢å¼• 4 çš„ä½ç½®ã€‚å®ƒå¯ä»¥å’Œç´¢å¼• 1, 3, 5 çš„æ•°å­—äº¤æ¢ã€‚
 * äº¤æ¢åä¼šå¾—åˆ°å‡ ä¸ªæ–°çš„çŠ¶æ€å­—ç¬¦ä¸²ã€‚
 * **å¤„ç†æ–°çŠ¶æ€**ï¼šå¯¹äºæ¯ä¸€ä¸ªæ–°äº§ç”Ÿçš„çŠ¶æ€ï¼š
 * æ£€æŸ¥ä¸€ä¸‹å®ƒåœ¨â€œå·²è®¿é—®â€é›†åˆé‡Œå—ï¼Ÿ
 * å¦‚æœ**ä¸åœ¨**ï¼Œè¯´æ˜è¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡å‘ç°è¿™ä¸ªçŠ¶æ€ã€‚æŠŠå®ƒåŠ å…¥åˆ°é˜Ÿåˆ—ï¼ˆæ­¥æ•°æ˜¯ `k+1`ï¼‰ï¼Œå¹¶åŒæ—¶åŠ å…¥åˆ°â€œå·²è®¿é—®â€é›†åˆã€‚
 * å¦‚æœåœ¨ï¼Œè¯´æ˜æˆ‘ä»¬ä¹‹å‰å·²ç»é€šè¿‡æ›´å°‘æˆ–ç›¸ç­‰çš„æ­¥æ•°åˆ°è¾¾è¿‡è¿™é‡Œï¼Œå°±ä¸ç”¨ç®¡å®ƒäº†ã€‚

3. **å¾ªç¯ç»“æŸ**ï¼šå¦‚æœé˜Ÿåˆ—éƒ½ç©ºäº†ï¼Œè¿˜æ²¡æ‰¾åˆ°ç›®æ ‡çŠ¶æ€ï¼Œè¯´æ˜è¿™ä¸ªè°œé¢˜æ— è§£ã€‚è¿”å› `-1`ã€‚

#### 3. é¢è¯•å£è¿°æ€è·¯ (30ç§’ç‰ˆæœ¬)

> é¢è¯•å®˜ä½ å¥½ï¼Œå¯¹äºè¿™é“é¢˜ï¼Œæˆ‘çš„æ€è·¯æ˜¯è¿™æ ·çš„ï¼š
>
> 1. **å®šæ€§é—®é¢˜**ï¼šè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æ±‚è§£æœ€å°‘æ­¥æ•°çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ç«‹åˆ»æƒ³åˆ°äº†ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ç®—æ³•ã€‚
> 2. **æ ¸å¿ƒæ€è·¯**ï¼šæˆ‘ä¼šæŠŠæ¯ä¸€ç§æ£‹ç›˜çš„å¸ƒå±€çœ‹ä½œä¸€ä¸ªçŠ¶æ€èŠ‚ç‚¹ã€‚ä»åˆå§‹çŠ¶æ€å¼€å§‹ï¼Œé€šè¿‡ BFS å±‚å±‚éå†ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡çŠ¶æ€ã€‚
> 3. **å®ç°ç»†èŠ‚**ï¼š
> * æˆ‘ä¼šç”¨ä¸€ä¸ª**é˜Ÿåˆ—**æ¥å­˜å‚¨å¾…è®¿é—®çš„çŠ¶æ€å’Œåˆ°è¾¾è¯¥çŠ¶æ€çš„æ­¥æ•°ã€‚
> * ä¸ºäº†é˜²æ­¢é‡å¤è®¡ç®—å’Œæ­»å¾ªç¯ï¼Œæˆ‘ä¼šç”¨ä¸€ä¸ª**é›†åˆ(Set)**æ¥è®°å½•å·²ç»è®¿é—®è¿‡çš„çŠ¶æ€ã€‚
> * ä¸ºäº†æ–¹ä¾¿å­˜å‚¨åœ¨é›†åˆé‡Œï¼Œæˆ‘ä¼šæŠŠäºŒç»´çš„æ£‹ç›˜çŠ¶æ€**åºåˆ—åŒ–**æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚
> 4. **ç»“æŸæ¡ä»¶**ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œå¦‚æœè¿˜æ²¡æ‰¾åˆ°ç›®æ ‡çŠ¶æ€ï¼Œå°±è¯´æ˜æ— è§£ï¼Œè¿”å›-1ã€‚å¦åˆ™ï¼Œç¬¬ä¸€æ¬¡æ‰¾åˆ°ç›®æ ‡çŠ¶æ€æ—¶çš„æ­¥æ•°å°±æ˜¯æœ€å°‘æ­¥æ•°ã€‚

è¿™å¥—è¯´è¾æ¸…æ™°ã€æœ‰æ¡ç†ï¼Œç›´æ¥ä½“ç°äº†ä½ åˆ†æé—®é¢˜å’Œé€‰æ‹©åˆé€‚ç®—æ³•çš„èƒ½åŠ›ã€‚

#### 4. ä»£ç å®ç° (Python)

```python
import collections

def sliding_puzzle(board: list[list[int]]) -> int:
    """
    ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ (BFS) è§£å†³æ»‘åŠ¨è°œé¢˜é—®é¢˜ã€‚

    Args:
        board: ä¸€ä¸ª 2x3 çš„äºŒç»´åˆ—è¡¨ï¼Œä»£è¡¨è°œé¢˜çš„åˆå§‹çŠ¶æ€ã€‚

    Returns:
        è¿”å›ä»åˆå§‹çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€æ‰€éœ€çš„æœ€å°‘ç§»åŠ¨æ¬¡æ•°ï¼Œå¦‚æœæ— è§£åˆ™è¿”å› -1ã€‚
    """
    # ç›®æ ‡çŠ¶æ€
    target = "123450"
    
    # 1. çŠ¶æ€åºåˆ—åŒ–ï¼šå°†äºŒç»´åˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæ–¹ä¾¿å¤„ç†å’Œå­˜å‚¨
    start_state = "".join(str(num) for row in board for num in row)
    
    # 2. åˆå§‹åŒ–é˜Ÿåˆ—å’Œå·²è®¿é—®é›†åˆ
    # é˜Ÿåˆ—ä¸­å­˜å‚¨ (å½“å‰çŠ¶æ€å­—ç¬¦ä¸², åˆ°è¾¾è¯¥çŠ¶æ€çš„æ­¥æ•°)
    queue = collections.deque([(start_state, 0)])
    # é›†åˆç”¨äºè®°å½•å·²è®¿é—®è¿‡çš„çŠ¶æ€ï¼Œé˜²æ­¢èµ°å›å¤´è·¯
    visited = {start_state}
    
    # 3. é¢„å…ˆè®¡ç®—å¥½æ¯ä¸ªä½ç½®å¯ä»¥äº¤æ¢çš„é‚»å±…ä½ç½®ç´¢å¼•
    # è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ä¼˜åŒ–ï¼Œé¿å…åœ¨å¾ªç¯ä¸­åå¤è®¡ç®—
    # ç´¢å¼•: 0 1 2
    #      3 4 5
    neighbors = {
        0: [1, 3],
        1: [0, 2, 4],
        2: [1, 5],
        3: [0, 4],
        4: [1, 3, 5],
        5: [2, 4]
    }
    
    # 4. å¼€å§‹ BFS å¾ªç¯
    while queue:
        current_state, steps = queue.popleft()
        
        # æ£€æŸ¥æ˜¯å¦åˆ°è¾¾ç›®æ ‡çŠ¶æ€
        if current_state == target:
            return steps
        
        # æ‰¾åˆ° '0' çš„ä½ç½®
        zero_index = current_state.find('0')
        
        # éå†æ‰€æœ‰å¯èƒ½çš„ä¸‹ä¸€æ­¥
        for neighbor_index in neighbors[zero_index]:
            # ç”Ÿæˆæ–°çŠ¶æ€ï¼ˆé€šè¿‡äº¤æ¢ '0' å’Œé‚»å±…ï¼‰
            temp_list = list(current_state)
            temp_list[zero_index], temp_list[neighbor_index] = temp_list[neighbor_index], temp_list[zero_index]
            new_state = "".join(temp_list)
            
            # å¦‚æœæ–°çŠ¶æ€æ²¡æœ‰è¢«è®¿é—®è¿‡ï¼Œåˆ™åŠ å…¥é˜Ÿåˆ—å’Œå·²è®¿é—®é›†åˆ
            if new_state not in visited:
                visited.add(new_state)
                queue.append((new_state, steps + 1))
                
    # 5. å¦‚æœé˜Ÿåˆ—ä¸ºç©ºè¿˜æ²¡æ‰¾åˆ°ç›®æ ‡ï¼Œè¯´æ˜æ— è§£
    return -1

# ç¤ºä¾‹
# board = [[1,2,3],[4,0,5]]
# print(sliding_puzzle(board)) # è¾“å‡º: 1

# board = [[4,1,2],[5,0,3]]
# print(sliding_puzzle(board)) # è¾“å‡º: 5
```

#### æ€»ç»“

å¯¹äºä½ ç›®å‰çš„æƒ…å†µï¼ŒæŒæ¡ BFS æ¨¡æ¿æ˜¯æŠ•å…¥äº§å‡ºæ¯”æœ€é«˜çš„äº‹æƒ…ä¹‹ä¸€ã€‚

* **è®°ä½æ¨¡æ¿**ï¼šé˜Ÿåˆ— + é›†åˆ + çŠ¶æ€è¡¨ç¤ºã€‚
* **è¯†åˆ«é¢˜å‹**ï¼šé—®â€œæœ€å°‘â€ã€â€œæœ€çŸ­â€æ¬¡æ•°ï¼Œä¸”æ¯ä¸€æ­¥çš„â€œä»£ä»·â€éƒ½æ˜¯1ã€‚
* **å¥—ç”¨æ¨¡æ¿**ï¼šæ€è€ƒå¦‚ä½•è¡¨ç¤ºçŠ¶æ€ã€å¦‚ä½•ä»ä¸€ä¸ªçŠ¶æ€è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚

è¿™é“é¢˜ææ‡‚äº†ï¼Œåƒâ€œå•è¯æ¥é¾™â€ã€â€œæ‰“å¼€è½¬ç›˜é”â€ç­‰ä¸€ç³»åˆ— LeetCode ç»å…¸é¢˜ç›®ï¼Œä½ éƒ½èƒ½ç”¨åŒæ ·çš„æ€è·¯å¿«é€Ÿè§£å†³ï¼Œé¢è¯•ä¸­é‡åˆ°è¿™ç±»é—®é¢˜åŸºæœ¬å°±ç¨³äº†ã€‚

---
## ğŸ§‘â€ğŸ’» User

if start == target:
 return 0 è¿™ä¸ªè¾¹ç•Œæ¡ä»¶ä¸ºä»€ä¹ˆè¦ä¸€å®šå•ç‹¬å†™å‡ºæ¥ï¼Ÿåé¢çš„ bfs ä¸èƒ½è¦†ç›–å—ï¼Ÿ

---
## ğŸ¤– Assistant

ä¸æ˜¯è¯´ã€Œä¸€å®šè¦ã€å•ç‹¬å†™è¿™ä¸€å¥ï¼Œè€Œæ˜¯**ç»“åˆæˆ‘ä¹‹å‰ç»™çš„é‚£ä»½ä»£ç ç»“æ„ï¼Œå¦‚æœå»æ‰è¿™å¥ï¼Œé€»è¾‘ä¼šå‡ºé”™**ï¼›å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æ”¹å†™ BFSï¼Œè®© BFS è‡ªå·±è¦†ç›–è¿™ä¸ªæƒ…å†µã€‚

---

### 1. å…ˆçœ‹ç°åœ¨è¿™ä»½ä»£ç çš„é€»è¾‘

ä¹‹å‰çš„æ ¸å¿ƒä»£ç æ˜¯è¿™æ ·çš„ï¼ˆç®€åŒ–ä¸€ä¸‹ï¼‰ï¼š

```python
start = ...
target = '123450'

if start == target:
    return 0

queue = deque()
queue.append((start, 0))
visited = {start}

while queue:
    state, steps = queue.popleft()
    zero_idx = state.index('0')

    for next_idx in neighbors[zero_idx]:
        state_list = list(state)
        state_list[zero_idx], state_list[next_idx] = (
            state_list[next_idx], state_list[zero_idx]
        )
        new_state = ''.join(state_list)

        if new_state == target:
            return steps + 1

        if new_state not in visited:
            visited.add(new_state)
            queue.append((new_state, steps + 1))

return -1
```

è§‚å¯Ÿè¿™æ®µä»£ç ï¼š

- **åªæœ‰åœ¨ç”Ÿæˆ `new_state` çš„æ—¶å€™ï¼Œæ‰åˆ¤æ–­ `new_state == target`**
- **ä»æ¥æ²¡æœ‰åˆ¤æ–­è¿‡å½“å‰çš„ `state` æ˜¯ä¸æ˜¯ç›®æ ‡**

æ‰€ä»¥å¦‚æœä¸€å¼€å§‹ `start == target`ï¼Œæµç¨‹æ˜¯ï¼š

1. `if start == target:` è¿™ä¸€å¥åˆ æ‰çš„è¯ï¼Œä¸ä¼šæå‰è¿”å›ã€‚
2. è¿›å…¥ `while`ï¼Œ`state = start = target`ï¼Œä½†æ²¡æœ‰åˆ¤æ–­å®ƒæ˜¯å¦ç­‰äº targetã€‚
3. åªä¼šå»ç”Ÿæˆå®ƒçš„æ‰€æœ‰é‚»å±… `new_state`ï¼Œè¿™äº›é‚»å±…éƒ½ä¸æ˜¯ targetã€‚
4. BFS æŠŠæ‰€æœ‰çŠ¶æ€éƒ½æœå®Œï¼Œå§‹ç»ˆæ²¡é‡åˆ° `new_state == target`ï¼Œæœ€åè¿”å› `-1`ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼š
**åœ¨å½“å‰è¿™ä»½å†™æ³•é‡Œï¼Œä¸å•ç‹¬å†™ `if start == target`ï¼Œèµ·å§‹çŠ¶æ€ç­‰äºç›®æ ‡æ—¶ä¼šè¿”å›é”™ç­”æ¡ˆï¼ˆ-1ï¼Œè€Œä¸æ˜¯ 0ï¼‰ã€‚**

---

### 2. æ€ä¹ˆè®© BFS è‡ªå·±è¦†ç›–è¿™ä¸ªè¾¹ç•Œï¼Ÿ

æœ‰ä¸¤ç§å¸¸è§æ”¹æ³•ï¼Œä»»é€‰ä¸€ä¸ªï¼š

#### å†™æ³• Aï¼šåœ¨ BFS å¾ªç¯é‡Œæ£€æŸ¥å½“å‰çŠ¶æ€

è¿™æ ·å°±ä¸éœ€è¦å•ç‹¬çš„ `if start == target`ï¼š

```python
queue = deque()
queue.append((start, 0))
visited = {start}

while queue:
    state, steps = queue.popleft()

    # æŠŠâ€œå½“å‰çŠ¶æ€æ˜¯ä¸æ˜¯ç›®æ ‡â€çš„åˆ¤æ–­æ”¾åœ¨è¿™é‡Œ
    if state == target:
        return steps

    zero_idx = state.index('0')
    for next_idx in neighbors[zero_idx]:
        state_list = list(state)
        state_list[zero_idx], state_list[next_idx] = (
            state_list[next_idx], state_list[zero_idx]
        )
        new_state = ''.join(state_list)

        if new_state not in visited:
            visited.add(new_state)
            queue.append((new_state, steps + 1))

return -1
```

è¿™æ ·èµ·ç‚¹å°±æ˜¯ç›®æ ‡æ—¶ï¼š

- ç¬¬ä¸€æ¬¡ä»é˜Ÿåˆ—å¼¹å‡º `state == start == target`ï¼Œ
- ç«‹åˆ» `return steps`ï¼Œæ­¤æ—¶ `steps` æ˜¯ 0ã€‚

#### å†™æ³• Bï¼šå…¥é˜Ÿæ—¶å°±åˆ¤æ–­

ä¹Ÿå¯ä»¥åœ¨ä¸€å¼€å§‹å…¥é˜Ÿå‰æ£€æŸ¥ä¸€æ¬¡ï¼ˆå…¶å®å°±æ˜¯åŸæ¥çš„å•ç‹¬åˆ¤æ–­ï¼‰ï¼š

```python
if start == target:
    return 0
# åé¢å°±ä¸ç”¨åœ¨å¾ªç¯é‡Œå†åˆ¤æ–­ state == target äº†
```

ä¸¤ç§å†™æ³•éƒ½å¯ä»¥ï¼Œ**è¦ä¹ˆèµ·ç‚¹ä¹‹å‰åˆ¤æ–­ä¸€æ¬¡ï¼Œè¦ä¹ˆåœ¨ BFS å¾ªç¯é‡Œç»Ÿä¸€åˆ¤æ–­å½“å‰çŠ¶æ€**ã€‚
ä½†ä½ ä¸èƒ½ä¸¤è€…éƒ½æ²¡æœ‰ã€‚

---

### 3. é¢è¯•ä¸­å¯ä»¥æ€ä¹ˆè¯´ï¼ˆå£è¿°è¦ç‚¹ï¼‰

> è¿™é¢˜æˆ‘ç”¨ BFS æ±‚æœ€çŸ­æ­¥æ•°ã€‚éœ€è¦æ³¨æ„ä¸€ä¸ªè¾¹ç•Œæƒ…å†µï¼šå¦‚æœåˆå§‹æ£‹ç›˜å·²ç»æ˜¯ç›®æ ‡çŠ¶æ€ï¼Œç­”æ¡ˆåº”è¯¥æ˜¯ 0ã€‚
> æˆ‘çš„ä»£ç é‡Œæœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼š
> ä¸€ç§æ˜¯åœ¨ BFS ä¹‹å‰ `if start == target: return 0`ï¼›
> å¦ä¸€ç§æ˜¯åœ¨ BFS å¾ªç¯é‡Œï¼Œæ¯æ¬¡å¼¹å‡ºçŠ¶æ€æ—¶å…ˆåˆ¤æ–­ `if state == target: return steps`ã€‚
> åªè¦ä¿è¯â€œå½“å‰çŠ¶æ€â€è¢«æ£€æŸ¥åˆ°ï¼Œå°±ä¸ä¼šæ¼æ‰èµ·ç‚¹ç­‰äºç»ˆç‚¹è¿™ç§æƒ…å†µã€‚å½“å‰è¿™ä»½ä»£ç å› ä¸ºåªæ£€æŸ¥æ–°ç”Ÿæˆçš„çŠ¶æ€ï¼Œæ‰€ä»¥éœ€è¦å•ç‹¬å†™è¿™å¥åˆ¤æ–­ã€‚

---
## ğŸ§‘â€ğŸ’» User

å†è®²ä¸€ä¸‹åŠ›æ‰£é¢˜ç›®752. æ‰“å¼€è½¬ç›˜é”

---
## ğŸ¤– Assistant

è¿™é¢˜è·Ÿåˆšæ‰çš„ã€Œæ»‘åŠ¨æ‹¼å›¾ã€æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼š**åœ¨çŠ¶æ€å›¾é‡Œæ‰¾æœ€çŸ­æ­¥æ•° -> BFS**ã€‚åªæ˜¯æ£‹ç›˜æ¢æˆäº† 4 ä¸ªæ•°å­—è½®å­ã€‚

---

## 1. é¢˜ç›®æœ¬è´¨

- æœ‰ä¸€ä¸ª 4 ä½æ•°çš„å¯†ç é”ï¼Œæ¯ä¸€ä½æ˜¯ 0~9ã€‚
- èµ·å§‹çŠ¶æ€æ˜¯ `"0000"`ã€‚
- æ¯æ¬¡å¯ä»¥è½¬åŠ¨ä¸€ä¸ªè½®å­ï¼š
 - å¾€ä¸Šï¼š`9 -> 0` ä¹Ÿç®—ï¼›
 - å¾€ä¸‹ï¼š`0 -> 9` ä¹Ÿç®—ã€‚
- æœ‰ä¸€äº›ã€Œæ­»äº¡çŠ¶æ€ã€`deadends`ï¼Œä¸€æ—¦è½¬åˆ°è¿™äº›çŠ¶æ€å°±ç›´æ¥æŒ‚æ‰ï¼Œä¸èƒ½å†ç»§ç»­è½¬ã€‚
- é—®ï¼šä» `"0000"` è½¬åˆ° `target`ï¼Œæœ€å°‘å¤šå°‘æ­¥ï¼Ÿå¦‚æœä¸èƒ½åˆ°è¾¾ï¼Œè¿”å› -1ã€‚

**æœ¬è´¨ï¼š**

- æ¯ä¸€ä¸ª 4 ä½å­—ç¬¦ä¸²ï¼ˆå¦‚ `"0132"`ï¼‰æ˜¯å›¾ä¸Šçš„ä¸€ä¸ªç‚¹ï¼ˆçŠ¶æ€ï¼‰ã€‚
- ä¸€æ¬¡åˆæ³•è½¬åŠ¨ï¼ˆæŸä¸€ä½ +1/-1ï¼‰æ˜¯å›¾ä¸Šçš„ä¸€æ¡è¾¹ã€‚
- æ¯ä¸€æ­¥ä»£ä»·ç›¸åŒï¼Œæ±‚ä» `"0000"` åˆ° `target` çš„æœ€çŸ­æ­¥æ•° â‡’ **ç”¨ BFS**ã€‚

çŠ¶æ€æ€»æ•°æœ€å¤š `10^4 = 10000` ä¸ªï¼Œéå¸¸å°ï¼ŒBFS å®Œå…¨æ²¡é—®é¢˜ã€‚

---

## 2. ä¸ºä»€ä¹ˆç”¨ BFSï¼Ÿ

- æ¯æ¬¡æ“ä½œçš„æˆæœ¬éƒ½ä¸€æ ·ï¼ˆ1 æ­¥ï¼‰ï¼Œæ‰€ä»¥ã€Œæ­¥æ•°æœ€å°‘ã€å°±æ˜¯ã€Œè¾¹æ•°æœ€å°‘ã€ã€‚
- æ— æƒå›¾æœ€çŸ­è·¯å¾„ â‡’ æ ‡å‡†å¥—è·¯å°±æ˜¯ BFSã€‚
- DFS/å›æº¯ä¸ä¿è¯æ˜¯æœ€çŸ­è·¯å¾„ï¼Œè¿˜ä¼šèµ°å¾ˆå¤šå†¤æ‰è·¯ã€‚
- çŠ¶æ€åªæœ‰ 10000 ä¸ªï¼Œä¸Šä¸‹ç•Œéƒ½å›ºå®šï¼ŒBFS ä¸€åœˆæ‰«å®Œå³å¯ã€‚

---

## 3. å…³é”®è®¾è®¡ç‚¹

### 3.1 çŠ¶æ€è¡¨ç¤º

ç›´æ¥ç”¨å­—ç¬¦ä¸²è¡¨ç¤ºçŠ¶æ€ï¼š

- èµ·ç‚¹ï¼š`start = "0000"`
- ç›®æ ‡ï¼š`target`ï¼ˆè¾“å…¥ç»™çš„ï¼‰
- æ­»äº¡çŠ¶æ€ï¼šæ”¾åˆ°ä¸€ä¸ª `set` é‡Œï¼ŒæŸ¥èµ·æ¥æ˜¯ O(1)

### 3.2 å¦‚ä½•ç”Ÿæˆä¸€ä¸ªçŠ¶æ€çš„æ‰€æœ‰ä¸‹ä¸€æ­¥ï¼ˆé‚»å±…ï¼‰

å¯¹å½“å‰çŠ¶æ€ `s`ï¼Œæ¯”å¦‚ `"0390"`ï¼š

- å¯¹æ¯ä¸€ä½ iï¼ˆ0~3ï¼‰ï¼š
 - å¾€ä¸Šè½¬ï¼šè¯¥ä½æ•°å­— +1ï¼ˆ9 å˜ 0ï¼‰ï¼›
 - å¾€ä¸‹è½¬ï¼šè¯¥ä½æ•°å­— -1ï¼ˆ0 å˜ 9ï¼‰ã€‚
- æ¯ä¸€ä½æœ‰ 2 ç§è½¬æ³•ï¼Œä¸€å…± 4 * 2 = 8 ä¸ªé‚»å±…ã€‚

ä¾‹å¦‚ `s = "0000"`ï¼š

- æ”¹ç¬¬ 0 ä½ï¼š`"1000"`, `"9000"`
- æ”¹ç¬¬ 1 ä½ï¼š`"0100"`, `"0900"`
- æ”¹ç¬¬ 2 ä½ï¼š`"0010"`, `"0090"`
- æ”¹ç¬¬ 3 ä½ï¼š`"0001"`, `"0009"`

### 3.3 BFS ç»“æ„

å…¸å‹æ¨¡æ¿ï¼š

- é˜Ÿåˆ—å…ƒç´ ï¼š`(çŠ¶æ€å­—ç¬¦ä¸², å½“å‰æ­¥æ•°)`
- `visited` é›†åˆé˜²æ­¢é‡å¤è®¿é—®ã€‚
- æ³¨æ„å‡ ä¸ªè¾¹ç•Œï¼š
 1. `start` å°±æ˜¯æ­»äº¡çŠ¶æ€ â‡’ ç›´æ¥è¿”å› -1ã€‚
 2. `start == target` â‡’ è¿”å› 0ã€‚
 3. BFS å¼¹å‡ºä¸€ä¸ªçŠ¶æ€æ—¶å…ˆåˆ¤æ–­æ˜¯å¦æ˜¯ `target`ã€‚

---

## 4. ä»£ç å®ç°ï¼ˆPythonï¼ŒBFSè§£æ³•ï¼‰

```python
from collections import deque
from typing import List, Set


class Solution:
    def openLock(self, deadends: List[str], target: str) -> int:
        """ä½¿ç”¨ BFS æ±‚è§£æœ€å°‘è½¬åŠ¨æ¬¡æ•°ã€‚

        æ¯ä¸ªå››ä½å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªçŠ¶æ€ï¼Œä» "0000" å¼€å§‹ï¼Œæ¯æ¬¡å¯ä»¥æŠŠæŸä¸€ä½ +1 æˆ– -1ï¼ˆç¯å½¢ï¼‰ï¼Œ
        é¿å¼€æ­»äº¡çŠ¶æ€ deadendsï¼Œæ±‚åˆ°è¾¾ target çš„æœ€å°‘æ­¥æ•°ã€‚

        Args:
            deadends: æ­»äº¡çŠ¶æ€åˆ—è¡¨ã€‚
            target: ç›®æ ‡é”çŠ¶æ€ã€‚

        Returns:
            æœ€å°‘æ­¥æ•°ï¼Œå¦‚æœä¸å¯è¾¾åˆ™è¿”å› -1ã€‚
        """
        start = "0000"
        dead: Set[str] = set(deadends)

        # è¾¹ç•Œæƒ…å†µï¼šèµ·ç‚¹å°±æ˜¯æ­»äº¡çŠ¶æ€ï¼Œåˆ™æ°¸è¿œæ‰“ä¸å¼€
        if start in dead:
            return -1

        # è¾¹ç•Œæƒ…å†µï¼šèµ·ç‚¹å·²ç»æ˜¯ç›®æ ‡
        if start == target:
            return 0

        # BFS åˆå§‹åŒ–
        queue = deque()
        queue.append((start, 0))  # (å½“å‰çŠ¶æ€, å·²èµ°æ­¥æ•°)
        visited = {start}

        while queue:
            state, steps = queue.popleft()

            # æ¯æ¬¡å¼¹å‡ºæ—¶æ£€æŸ¥æ˜¯å¦åˆ°è¾¾ target
            if state == target:
                return steps

            # æšä¸¾å½“å‰çŠ¶æ€çš„æ‰€æœ‰é‚»å±…
            for neighbor in self._get_neighbors(state):
                # é¿å¼€æ­»äº¡çŠ¶æ€å’Œå·²è®¿é—®çŠ¶æ€
                if neighbor in dead or neighbor in visited:
                    continue
                visited.add(neighbor)
                queue.append((neighbor, steps + 1))

        # BFS ç»“æŸè¿˜æ²¡æ‰¾åˆ° targetï¼Œè¯´æ˜ä¸å¯è¾¾
        return -1

    def _get_neighbors(self, state: str) -> List[str]:
        """ç”Ÿæˆå½“å‰çŠ¶æ€é€šè¿‡ä¸€æ¬¡è½¬åŠ¨èƒ½åˆ°è¾¾çš„æ‰€æœ‰é‚»å±…çŠ¶æ€ã€‚"""
        neighbors = []
        for i in range(4):
            digit = int(state[i])

            # å¾€ä¸Šæ‹¨ä¸€æ ¼
            up = (digit + 1) % 10
            # å¾€ä¸‹æ‹¨ä¸€æ ¼
            down = (digit + 9) % 10  # ç­‰ä»·äº (digit - 1 + 10) % 10

            # æ„é€ æ–°å­—ç¬¦ä¸²
            neighbors.append(
                state[:i] + str(up) + state[i + 1:]
            )
            neighbors.append(
                state[:i] + str(down) + state[i + 1:]
            )

        return neighbors
```

---

## 5. å¤æ‚åº¦ & é¢è¯•è¦ç‚¹

**å¤æ‚åº¦ï¼š**

- çŠ¶æ€æ€»æ•°æœ€å¤š `10^4`ï¼›æ¯ä¸ªçŠ¶æ€æœ€å¤š 8 ä¸ªé‚»å±…ã€‚
- BFS æœ€å¤šè®¿é—®æ¯ä¸ªçŠ¶æ€ä¸€æ¬¡ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ O(10000) â‰ˆ O(1) å¸¸æ•°çº§ã€‚
- ç©ºé—´å¤æ‚åº¦åŒæ · O(10000) â‰ˆ O(1)ï¼Œä¸»è¦æ˜¯ `visited` å’Œé˜Ÿåˆ—ã€‚

---

## 6. é¢è¯•ä¸­ 30 ç§’å£è¿°æ€è·¯ï¼ˆå¯ä»¥èƒŒï¼‰

> è¿™é¢˜æˆ‘æŠŠæ¯ä¸ª 4 ä½é”çŠ¶æ€å½“æˆå›¾ä¸Šçš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä» "0000" åˆ° target æ‰¾æœ€å°‘æ­¥æ•°ï¼Œç”¨ BFS åšã€‚
> å¯¹äºä»»æ„ä¸€ä¸ªçŠ¶æ€ï¼Œå®ƒçš„é‚»å±…æ˜¯æŠŠå››ä¸ªä½ç½®ä¸­çš„ä»»æ„ä¸€ä½å¾€ä¸Šæˆ–å¾€ä¸‹æ‹¨ä¸€æ ¼ï¼Œä¸€å…± 8 ä¸ªé‚»å±…ã€‚
> æˆ‘å…ˆæŠŠ deadends æ”¾åˆ°å“ˆå¸Œè¡¨é‡Œï¼Œèµ·ç‚¹åœ¨ dead é‡Œç›´æ¥è¿”å› -1ï¼Œèµ·ç‚¹ç­‰äº target è¿”å› 0ã€‚
> ç„¶åç”¨é˜Ÿåˆ—åš BFSï¼Œä¿å­˜ `(çŠ¶æ€, æ­¥æ•°)`ï¼Œæ¯æ¬¡ä»é˜Ÿå¤´å–å‡ºçŠ¶æ€ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦ç­‰äº targetï¼Œæ˜¯çš„è¯è¿”å›å½“å‰æ­¥æ•°ã€‚
> å¦åˆ™ç”Ÿæˆæ‰€æœ‰é‚»å±…ï¼Œè¿‡æ»¤æ‰æ­»äº¡çŠ¶æ€å’Œè®¿é—®è¿‡çš„çŠ¶æ€ï¼Œå…¥é˜Ÿç»§ç»­æœç´¢ã€‚
> çŠ¶æ€ç©ºé—´åªæœ‰ 10^4ï¼ŒBFS åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½æ²¡é—®é¢˜ã€‚

---
## ğŸ¤– Assistant

å¥½çš„ï¼Œæ²¡é—®é¢˜ã€‚æˆ‘ä»¬æ¥çœ‹åŠ›æ‰£ 752. æ‰“å¼€è½¬ç›˜é”ã€‚

è¿™é“é¢˜å’Œä¸Šä¸€é“ã€Œæ»‘åŠ¨è°œé¢˜ã€åœ¨**æœ¬è´¨ä¸Šæ˜¯åŒä¸€ç±»é—®é¢˜**ï¼Œéƒ½æ˜¯åœ¨çŠ¶æ€ç©ºé—´ä¸­æ‰¾æœ€çŸ­è·¯å¾„ï¼Œæ‰€ä»¥è§£æ³•ä¹Ÿå®Œå…¨ä¸€æ ·ï¼š**BFS**ã€‚

---

### 1. é¢˜ç›®æœ¬è´¨ï¼šåˆæ˜¯ BFS æ‰¾æœ€çŸ­è·¯å¾„

é¢˜æ„ç®€åŒ–ï¼š

- æœ‰ä¸€ä¸ª 4 ä½å¯†ç é”ï¼Œæ¯ä½æ˜¯ 0-9ã€‚
- åˆå§‹çŠ¶æ€æ˜¯ `"0000"`ã€‚
- æ¯æ¬¡å¯ä»¥æŠŠ**ä¸€ä½**æ•°å­—**å‘ä¸Šæˆ–å‘ä¸‹**æ‹¨åŠ¨ä¸€ä¸‹ï¼ˆä¾‹å¦‚ '0' å¯ä»¥å˜æˆ '1' æˆ– '9'ï¼‰ã€‚
- æœ‰ä¸€ä¸ª `deadends` åˆ—è¡¨ï¼Œè¿™äº›å¯†ç æ˜¯â€œæ­»äº¡å¯†ç â€ï¼Œä¸èƒ½ç»è¿‡ã€‚
- ç›®æ ‡æ˜¯è½¬åˆ° `target` å¯†ç ã€‚
- é—®ï¼šæœ€å°‘éœ€è¦è½¬å¤šå°‘æ¬¡ï¼Ÿå¦‚æœæ°¸è¿œåˆ°ä¸äº†ï¼Œè¿”å› -1ã€‚

**æœ¬è´¨åˆ†æï¼š**

- **çŠ¶æ€ï¼ˆå›¾ä¸Šçš„ç‚¹ï¼‰ï¼š** æ¯ä¸€ä¸ª 4 ä½å¯†ç ç»„åˆï¼ˆ"0000" åˆ° "9999"ï¼‰éƒ½æ˜¯ä¸€ä¸ªçŠ¶æ€ã€‚
- **è½¬ç§»ï¼ˆå›¾ä¸Šçš„è¾¹ï¼‰ï¼š** æ‹¨åŠ¨ä¸€æ¬¡å¯†ç é”ï¼Œå°±æ˜¯ä»ä¸€ä¸ªçŠ¶æ€ç§»åŠ¨åˆ°å¦ä¸€ä¸ªçŠ¶æ€ã€‚æ¯ä¸ªçŠ¶æ€éƒ½æœ‰ 8 ä¸ªç›¸é‚»çŠ¶æ€ï¼ˆ4 ä¸ªè½®ç›˜ï¼Œæ¯ä¸ªè½®ç›˜å¯ä»¥å‘ä¸Šæˆ–å‘ä¸‹æ‹¨åŠ¨ï¼‰ã€‚
- **æ­»äº¡å¯†ç ï¼ˆå›¾ä¸Šè¢«ç§»é™¤çš„ç‚¹ï¼‰ï¼š** `deadends` åˆ—è¡¨é‡Œçš„çŠ¶æ€æ˜¯ç¦åŒºï¼Œä¸èƒ½è®¿é—®ã€‚
- **é—®é¢˜ï¼š** æ±‚ä» `"0000"` åˆ° `target` çš„**æœ€çŸ­è·¯å¾„**ï¼Œä¸”è·¯å¾„ä¸èƒ½ç»è¿‡æ­»äº¡ç‚¹ã€‚

**ç»“è®ºï¼š**
è¿™åˆæ˜¯ä¸€ä¸ª**æ— æƒå›¾æœ€çŸ­è·¯å¾„**é—®é¢˜ï¼ŒBFS æ˜¯æ ‡å‡†ä¸”æœ€é«˜æ•ˆçš„è§£æ³•ã€‚

---

### 2. ä¸ºä»€ä¹ˆç”¨ BFSï¼Ÿ

- **ä¿è¯æœ€çŸ­ï¼š** BFS æŒ‰å±‚çº§ï¼ˆæ­¥æ•°ï¼‰æ‰©å±•ï¼Œä¸€å±‚ä¸€å±‚åœ°å‘å¤–æœç´¢ã€‚æ‰€ä»¥ï¼Œå½“å®ƒç¬¬ä¸€æ¬¡æ‰¾åˆ° `target` æ—¶ï¼Œç»è¿‡çš„å±‚æ•°ä¸€å®šæ˜¯æœ€å°‘çš„æ­¥æ•°ã€‚
- **é¿å…æ­»å¾ªç¯å’Œå†—ä½™è®¡ç®—ï¼š** é…åˆä¸€ä¸ª `visited` é›†åˆï¼Œå¯ä»¥ç¡®ä¿æ¯ä¸ªå¯†ç çŠ¶æ€åªè¢«è®¿é—®ä¸€æ¬¡ï¼Œä¸ä¼šåœ¨ä¸¤ä¸ªçŠ¶æ€ä¹‹é—´æ¥å›è½¬åŠ¨ï¼Œä¹Ÿä¸ä¼šé‡å¤è®¡ç®—å·²ç»å¤„ç†è¿‡çš„çŠ¶æ€ã€‚
- **çŠ¶æ€ç©ºé—´å¯æ§ï¼š** å¯†ç ç»„åˆæ€»å…±åªæœ‰ `10^4 = 10000` ç§ï¼Œè¿™ä¸ªæ•°é‡å¯¹äº BFS æ¥è¯´éå¸¸å°ï¼Œå®Œå…¨å¯ä»¥åœ¨é™å®šæ—¶é—´å†…æœå®Œã€‚

---

### 3. å…³é”®è®¾è®¡ï¼šå¦‚ä½•å®ç° BFS

#### 3.1 çŠ¶æ€è¡¨ç¤º

ç›´æ¥ç”¨å­—ç¬¦ä¸²ï¼ˆå¦‚ "0102"ï¼‰æ¥è¡¨ç¤ºå¯†ç é”çš„çŠ¶æ€ï¼Œç®€å•ç›´è§‚ã€‚

#### 3.2 å¦‚ä½•ç”Ÿæˆä¸‹ä¸€æ­¥çš„æ‰€æœ‰çŠ¶æ€ï¼ˆé‚»å±…ï¼‰

è¿™æ˜¯æœ¬é¢˜çš„æ ¸å¿ƒã€‚å¯¹äºä¸€ä¸ªå¯†ç  `s`ï¼Œæ¯”å¦‚ "1234"ï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆ 8 ä¸ªé‚»å±…ï¼š

1. **ç¬¬ä¸€ä½** '1' -> '0' æˆ– '2'ï¼Œå¾—åˆ° "0234", "2234"
2. **ç¬¬äºŒä½** '2' -> '1' æˆ– '3'ï¼Œå¾—åˆ° "1134", "1334"
3. ...ä»¥æ­¤ç±»æ¨

å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªå¯†ç å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªåŒ…å« 8 ä¸ªæ–°å¯†ç å­—ç¬¦ä¸²çš„åˆ—è¡¨ã€‚
ä¸€ä¸ªå°æŠ€å·§æ˜¯å¤„ç†æ•°å­—çš„å¾ªç¯ï¼š
- å‘ä¸Šæ‹¨ï¼š`(digit + 1) % 10`
- å‘ä¸‹æ‹¨ï¼š`(digit - 1 + 10) % 10` ï¼ˆ`+10` æ˜¯ä¸ºäº†é˜²æ­¢ `0-1` å˜æˆ `-1`ï¼‰

#### 3.3 å¦‚ä½•å¤„ç† `deadends` å’Œ `visited`

ä¸ºäº† O(1) çš„æŸ¥è¯¢æ•ˆç‡ï¼Œå¿…é¡»æŠŠ `deadends` åˆ—è¡¨è½¬æ¢æˆä¸€ä¸ª**é›†åˆï¼ˆSetï¼‰**ã€‚
`visited` é›†åˆç”¨æ¥å­˜å‚¨æ‰€æœ‰å·²ç»è®¿é—®è¿‡çš„çŠ¶æ€ï¼ˆåŒ…æ‹¬ `deadends` å’Œé˜Ÿåˆ—ä¸­å¤„ç†è¿‡çš„çŠ¶æ€ï¼‰ï¼Œé¿å…èµ°å›å¤´è·¯å’Œç¦åŒºã€‚

#### 3.4 BFS ç»“æ„

1. **åˆå§‹åŒ–ï¼š**
 - åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ï¼ŒæŠŠ `("0000", 0)` æ”¾è¿›å»ï¼ˆçŠ¶æ€ï¼Œæ­¥æ•°ï¼‰ã€‚
 - åˆ›å»ºä¸€ä¸ª `visited` é›†åˆï¼Œå…ˆæŠŠæ‰€æœ‰ `deadends` æ”¾è¿›å»ï¼Œå†æŠŠ `"0000"` æ”¾è¿›å»ã€‚
 - **ç‰¹åˆ«æ³¨æ„ä¸€ä¸ªè¾¹ç•Œï¼š** å¦‚æœ `"0000"` æœ¬èº«å°±åœ¨ `deadends` é‡Œï¼Œç›´æ¥è¿”å› -1ã€‚
2. **å¾ªç¯ï¼š**
 - å½“é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå¼¹å‡ºä¸€ä¸ª `(current_state, steps)`ã€‚
 - **æ£€æŸ¥æ˜¯å¦åˆ°è¾¾ç»ˆç‚¹ï¼š** `if current_state == target`ï¼Œç›´æ¥è¿”å› `steps`ã€‚
 - **ç”Ÿæˆé‚»å±…ï¼š** è°ƒç”¨å‡½æ•°ç”Ÿæˆ 8 ä¸ªä¸‹ä¸€æ­¥çŠ¶æ€ã€‚
 - **è¿‡æ»¤å¹¶å…¥é˜Ÿï¼š** å¯¹äºæ¯ä¸ªé‚»å±…ï¼Œå¦‚æœå®ƒä¸åœ¨ `visited` é›†åˆé‡Œï¼š
 - æŠŠå®ƒåŠ å…¥ `visited` é›†åˆã€‚
 - æŠŠå®ƒå’Œ `steps + 1` ä¸€èµ·åŠ å…¥é˜Ÿåˆ—ã€‚
3. **å¾ªç¯ç»“æŸï¼š** å¦‚æœé˜Ÿåˆ—ç©ºäº†è¿˜æ²¡æ‰¾åˆ° `target`ï¼Œè¯´æ˜æ— æ³•åˆ°è¾¾ï¼Œè¿”å› -1ã€‚

---

### 4. ä»£ç å®ç°ï¼ˆPythonï¼Œå¸¦ä¸­æ–‡æ³¨é‡Šï¼‰

```python
from collections import deque
from typing import List


class Solution:
    def openLock(self, deadends: List[str], target: str) -> int:
        """è®¡ç®—æ‰“å¼€è½¬ç›˜é”çš„æœ€å°‘æ¬¡æ•°ã€‚

        è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰è§£å†³ã€‚
        å°†æ¯ç§å¯†ç ç»„åˆè§†ä¸ºå›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯æ¬¡è½¬åŠ¨ä¸€ä½è§†ä¸ºä¸€æ¡è¾¹ã€‚

        Args:
            deadends: æ­»äº¡å¯†ç åˆ—è¡¨ï¼Œè¿™äº›èŠ‚ç‚¹ä¸å¯è®¿é—®ã€‚
            target: ç›®æ ‡å¯†ç ã€‚

        Returns:
            ä» "0000" åˆ°è¾¾ target çš„æœ€å°‘æ­¥æ•°ï¼Œå¦‚æœæ— æ³•åˆ°è¾¾åˆ™è¿”å› -1ã€‚
        """
        # 1. åˆå§‹åŒ– visited é›†åˆï¼Œä¸ºäº† O(1) æŸ¥è¯¢æ•ˆç‡
        deadends_set = set(deadends)
        start = "0000"

        # 2. å¤„ç†è¾¹ç•Œæƒ…å†µï¼šå¦‚æœèµ·ç‚¹å°±æ˜¯æ­»äº¡å¯†ç ï¼Œæ°¸è¿œæ— æ³•å¼€å§‹
        if start in deadends_set:
            return -1
        
        # å¦‚æœèµ·ç‚¹å°±æ˜¯ç›®æ ‡ï¼Œä¸éœ€è¦è½¬åŠ¨
        if start == target:
            return 0

        # 3. åˆå§‹åŒ– BFS é˜Ÿåˆ—å’Œ visited é›†åˆ
        queue = deque()
        queue.append((start, 0))  # (å½“å‰å¯†ç , å·²ç”¨æ­¥æ•°)
        visited = {start} | deadends_set  # å°†èµ·ç‚¹å’Œæ­»äº¡å¯†ç éƒ½åŠ å…¥å·²è®¿é—®é›†åˆ

        # 4. å¼€å§‹ BFS
        while queue:
            current_code, steps = queue.popleft()

            # éå†å½“å‰å¯†ç çš„æ¯ä¸€ä½æ•°å­—
            for i in range(4):
                digit = int(current_code[i])
                
                # å‘ä¸Šå’Œå‘ä¸‹æ‹¨åŠ¨
                for move in [-1, 1]:
                    # è®¡ç®—æ–°æ•°å­—ï¼Œå¤„ç† '0'->'9' å’Œ '9'->'0' çš„å¾ªç¯æƒ…å†µ
                    new_digit = (digit + move + 10) % 10
                    
                    # æ„å»ºæ–°å¯†ç å­—ç¬¦ä¸²
                    new_code = (
                        current_code[:i] + str(new_digit) + current_code[i+1:]
                    )
                    
                    # å¦‚æœæ–°å¯†ç æ˜¯ç›®æ ‡ï¼Œç›´æ¥è¿”å›æ­¥æ•°+1
                    if new_code == target:
                        return steps + 1
                    
                    # å¦‚æœæ–°å¯†ç æ²¡è¢«è®¿é—®è¿‡ï¼ˆä¹Ÿä¸æ˜¯æ­»äº¡å¯†ç ï¼‰
                    if new_code not in visited:
                        visited.add(new_code)
                        queue.append((new_code, steps + 1))
        
        # 5. é˜Ÿåˆ—ä¸ºç©ºä¹Ÿæ²¡æ‰¾åˆ°ç›®æ ‡ï¼Œè¯´æ˜æ— æ³•åˆ°è¾¾
        return -1
```

---

### 5. å¤æ‚åº¦ & é¢è¯•å¯è¯´ç‚¹

**æ—¶é—´å¤æ‚åº¦ï¼š** O($N \cdot k + D$)
- N æ˜¯çŠ¶æ€æ€»æ•°ï¼Œè¿™é‡Œæ˜¯ $10^4$ã€‚
- k æ˜¯æ¯ä¸ªçŠ¶æ€çš„åˆ†æ”¯æ•°ï¼Œè¿™é‡Œæ˜¯ $4 \times 2 = 8$ã€‚
- D æ˜¯ `deadends` çš„æ•°é‡ï¼Œç”¨äºåˆå§‹åŒ–é›†åˆã€‚
- ç”±äº N å’Œ k éƒ½æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥å¤æ‚åº¦å¯ä»¥è®¤ä¸ºæ˜¯ O(D)ã€‚

**ç©ºé—´å¤æ‚åº¦ï¼š** O($N + D$)
- `queue` å’Œ `visited` æœ€å¤šå­˜å‚¨ N ä¸ªçŠ¶æ€ã€‚
- `deadends_set` å­˜å‚¨ D ä¸ªçŠ¶æ€ã€‚
- åŒæ ·ï¼Œç”±äº N æ˜¯å¸¸æ•°ï¼Œå¤æ‚åº¦å¯ä»¥è®¤ä¸ºæ˜¯ O(D)ã€‚

---

### 6. é¢è¯•ä¸­ 30 ç§’å†…çš„å£è¿°æ€è·¯ï¼ˆä½ å¯ä»¥èƒŒä¸€ä¸‹ï¼‰

> è¿™æ˜¯ä¸€ä¸ªåœ¨çŠ¶æ€ç©ºé—´é‡Œæ‰¾æœ€çŸ­è·¯å¾„çš„å…¸å‹é—®é¢˜ï¼Œæˆ‘ä¼šç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰æ¥è§£å†³ã€‚
>
> é¦–å…ˆï¼Œæˆ‘æŠŠæ¯ä¸ª 4 ä½å¯†ç çœ‹ä½œå›¾ä¸Šçš„ä¸€ä¸ªç‚¹ï¼ŒæŠŠè½¬åŠ¨ä¸€æ¬¡è½®ç›˜çœ‹ä½œè¿æ¥ä¸¤ä¸ªç‚¹çš„è¾¹ã€‚`deadends` å°±æ˜¯å›¾é‡Œä¸èƒ½è®¿é—®çš„ç‚¹ã€‚
>
> æˆ‘ä¼šç”¨ä¸€ä¸ªé˜Ÿåˆ—æ¥å®ç° BFSï¼Œä» "0000" å¼€å§‹ï¼Œä¸€å±‚å±‚åœ°æ¢ç´¢æ‰€æœ‰å¯è¾¾çš„å¯†ç ã€‚ä¸ºäº†é¿å…é‡å¤è®¡ç®—å’Œè¿›å…¥æ­»å¾ªç¯ï¼Œæˆ‘ä¼šç”¨ä¸€ä¸ª `visited` é›†åˆæ¥è®°å½•æ‰€æœ‰è®¿é—®è¿‡çš„å¯†ç å’Œæ­»äº¡å¯†ç ã€‚
>
> å› ä¸º BFS èƒ½ä¿è¯ç¬¬ä¸€æ¬¡æ‰¾åˆ°ç›®æ ‡æ—¶ï¼Œè·¯å¾„ä¸€å®šæ˜¯æœ€çŸ­çš„ï¼Œæ‰€ä»¥è¿™èƒ½ç›´æ¥å¾—åˆ°æœ€å°‘æ­¥æ•°ã€‚å¦‚æœé˜Ÿåˆ—éƒ½ç©ºäº†è¿˜æ²¡æ‰¾åˆ°ï¼Œå°±è¯´æ˜æ— è§£ï¼Œè¿”å› -1ã€‚è¿™ä¸ªé—®é¢˜çš„çŠ¶æ€ç©ºé—´åªæœ‰ 1 ä¸‡ï¼Œæ‰€ä»¥ BFS æ•ˆç‡éå¸¸é«˜ã€‚

---
## ğŸ§‘â€ğŸ’» User

æˆ‘ä»¬åœ¨å†™ BFS æ—¶ï¼Œç»å¸¸ç”¨åˆ°çš„ä¸€ä¸ªå†™æ³•æ˜¯åœ¨ while queue: è¯­å¥çš„åé¢å†™ä¸€å¥ level_size = len(queue)ï¼Œä¸ºä»€ä¹ˆè¿™é“é¢˜ä¸éœ€è¦ï¼Ÿ

---
## ğŸ¤– Assistant

è¿™ä¸¤ä¸ªå…¶å®æ˜¯ **ä¸¤ç§ BFS å†™æ³•**ï¼Œè¿™é¢˜ç”¨çš„æ˜¯å…¶ä¸­ä¸€ç§ï¼Œæ‰€ä»¥ä¸éœ€è¦ `level_size = len(queue)`ã€‚

---

## 1. å¸¸è§é‚£ç§éœ€è¦ `level_size` çš„ BFS é•¿å•¥æ ·ï¼Ÿ

æ¨¡æ¿å¤§æ¦‚æ˜¯è¿™æ ·ï¼ˆé˜Ÿåˆ—é‡Œåªæ”¾çŠ¶æ€ï¼Œä¸æ”¾æ­¥æ•°ï¼‰ï¼š

```python
from collections import deque

queue = deque()
queue.append(start)
steps = 0

while queue:
    level_size = len(queue)  # å½“å‰å±‚çš„èŠ‚ç‚¹æ•°

    for _ in range(level_size):
        state = queue.popleft()
        if state == target:
            return steps

        for neighbor in get_neighbors(state):
            if neighbor æ²¡è®¿é—®è¿‡:
                queue.append(neighbor)

    steps += 1  # è¿™ä¸€å±‚å¤„ç†å®Œäº†ï¼Œæ­¥æ•° +1
```

ç‰¹ç‚¹ï¼š

- é˜Ÿåˆ—é‡Œåªæœ‰ `state`ã€‚
- `steps` æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œè¡¨ç¤º **å½“å‰æ­£åœ¨å¤„ç†çš„æ˜¯ç¬¬å‡ å±‚**ã€‚
- é€šè¿‡ `level_size = len(queue)` ä¿è¯ `for` å¾ªç¯åªå¤„ç†è¿™ä¸€å±‚çš„èŠ‚ç‚¹ï¼Œå¤„ç†å®Œè¿™ä¸€å±‚å† `steps += 1`ã€‚

**`level_size` çš„ä½œç”¨**å°±æ˜¯ï¼š
æŠŠ BFS çš„â€œæŒ‰å±‚ï¼ˆæŒ‰æ­¥æ•°ï¼‰â€å¤„ç†æ˜¾å¼å†™å‡ºæ¥ï¼Œå¥½ç»´æŠ¤ `steps`ã€‚

---

## 2. è¿™é“é¢˜ï¼ˆæˆ‘ç»™çš„ä»£ç ï¼‰ç”¨çš„æ˜¯å¦ä¸€ç§å†™æ³•

æˆ‘ä»¬å†™çš„æ˜¯ **æŠŠæ­¥æ•°ä¸€èµ·å¡è¿›é˜Ÿåˆ—** çš„å†™æ³•ï¼š

```python
queue = deque()
queue.append((start, 0))  # (çŠ¶æ€, åˆ°è¾¾è¯¥çŠ¶æ€çš„æ­¥æ•°)

while queue:
    state, steps = queue.popleft()

    if state == target:
        return steps

    for neighbor in get_neighbors(state):
        if neighbor æ²¡è®¿é—®è¿‡:
            queue.append((neighbor, steps + 1))
```

ç‰¹ç‚¹ï¼š

- é˜Ÿåˆ—é‡Œæ”¾çš„æ˜¯ `(state, steps)`ã€‚
- æ¯ä¸ªèŠ‚ç‚¹è‡ªå·±å¸¦ç€â€œæˆ‘èµ°äº†å¤šå°‘æ­¥â€è¿™ä¸ªä¿¡æ¯ã€‚
- ä¸éœ€è¦å…³å¿ƒâ€œå½“å‰å±‚æœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹â€ï¼Œå› ä¸º `steps` æ˜¯å±€éƒ¨å‡†ç¡®çš„ï¼š
ä½ ä» `steps` æ¨å‡ºå»çš„é‚»å±…æ­¥æ•°è‡ªç„¶æ˜¯ `steps + 1`ã€‚

**æ‰€ä»¥è¿™é‡Œä¸éœ€è¦ `level_size = len(queue)`ï¼Œå› ä¸ºæˆ‘ä»¬æ ¹æœ¬æ²¡ç”¨â€œæŒ‰å±‚è®¡æ­¥â€çš„é‚£ä¸ªå¥—è·¯ã€‚**

---

## 3. ä¸¤ç§å†™æ³•è°å¯¹è°é”™ï¼Ÿ

éƒ½å¯¹ï¼Œæœ¬è´¨å®Œå…¨ä¸€æ ·ï¼š

- å†™æ³• Aï¼šé˜Ÿåˆ—åªæ”¾çŠ¶æ€ï¼Œç”¨ `level_size` + å¤–éƒ¨ `steps` æ¥æŒ‰å±‚æ•°è®¡æ­¥ã€‚
- å†™æ³• Bï¼šé˜Ÿåˆ—æ”¾ `(çŠ¶æ€, æ­¥æ•°)`ï¼Œæ¯ä¸ªèŠ‚ç‚¹è‡ªå·±æºå¸¦æ­¥æ•°ï¼Œä¸éœ€è¦ `level_size`ã€‚

è¿™é¢˜æˆ‘ä»¬é€‰äº†å†™æ³• Bï¼Œæ‰€ä»¥è‡ªç„¶ä¸éœ€è¦ `level_size`ã€‚

å¦‚æœä½ å¾ˆä¹ æƒ¯æŒ‰å±‚çš„å†™æ³•ï¼Œä¹Ÿå¯ä»¥æ”¹æˆå†™æ³• Aï¼Œæ¯”å¦‚åœ¨è¿™é¢˜ä¸Šè¿™æ ·å†™ï¼š

```python
from collections import deque

def openLock(deadends, target):
    start = "0000"
    dead = set(deadends)
    if start in dead:
        return -1
    if start == target:
        return 0

    queue = deque([start])
    visited = {start}
    steps = 0

    while queue:
        level_size = len(queue)
        for _ in range(level_size):
            state = queue.popleft()
            if state == target:
                return steps

            for neighbor in get_neighbors(state):
                if neighbor in dead or neighbor in visited:
                    continue
                visited.add(neighbor)
                queue.append(neighbor)
        steps += 1

    return -1
```

é€»è¾‘ä¸€æ ·ï¼Œåªæ˜¯å†™æ³•é£æ ¼ä¸åŒã€‚

---

## 4. é¢è¯•å£è¿°è¦ç‚¹ï¼ˆ10 ç§’ï¼‰

> BFS æœ‰ä¸¤ç§å¸¸è§å†™æ³•ï¼šä¸€ç§é˜Ÿåˆ—é‡Œåªå­˜çŠ¶æ€ï¼Œç”¨ `level_size` åˆ†å±‚ï¼Œå†åœ¨å¤–é¢ç»´æŠ¤æ­¥æ•°ï¼›å¦ä¸€ç§æ˜¯é˜Ÿåˆ—é‡Œç›´æ¥å­˜ `(çŠ¶æ€, æ­¥æ•°)`ï¼Œè¿™æ ·å°±ä¸éœ€è¦ `level_size`ã€‚
> è¿™é¢˜æˆ‘ç”¨çš„æ˜¯ç¬¬äºŒç§å†™æ³•ï¼Œæ‰€ä»¥ä¸éœ€è¦åœ¨ while é‡Œå†™ `level_size = len(queue)`ã€‚

---
## ğŸ§‘â€ğŸ’» User

é‚£ä¸‹é¢è¿™ç§å†™æ³•å‘¢ï¼Ÿfrom collections import deque
from typing import List


class Solution:
 def openLock(self, deadends: List[str], target: str) -> int:
 """è®¡ç®—æ‰“å¼€è½¬ç›˜é”çš„æœ€å°‘æ¬¡æ•°ã€‚

 è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰è§£å†³ã€‚
 å°†æ¯ç§å¯†ç ç»„åˆè§†ä¸ºå›¾ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯æ¬¡è½¬åŠ¨ä¸€ä½è§†ä¸ºä¸€æ¡è¾¹ã€‚

 Args:
 deadends: æ­»äº¡å¯†ç åˆ—è¡¨ï¼Œè¿™äº›èŠ‚ç‚¹ä¸å¯è®¿é—®ã€‚
 target: ç›®æ ‡å¯†ç ã€‚

 Returns:
 ä» "0000" åˆ°è¾¾ target çš„æœ€å°‘æ­¥æ•°ï¼Œå¦‚æœæ— æ³•åˆ°è¾¾åˆ™è¿”å› -1ã€‚
 """
 # 1. åˆå§‹åŒ– visited é›†åˆï¼Œä¸ºäº† O(1) æŸ¥è¯¢æ•ˆç‡
 deadends_set = set(deadends)
 start = "0000"

 # 2. å¤„ç†è¾¹ç•Œæƒ…å†µï¼šå¦‚æœèµ·ç‚¹å°±æ˜¯æ­»äº¡å¯†ç ï¼Œæ°¸è¿œæ— æ³•å¼€å§‹
 if start in deadends_set:
 return -1

 # å¦‚æœèµ·ç‚¹å°±æ˜¯ç›®æ ‡ï¼Œä¸éœ€è¦è½¬åŠ¨
 if start == target:
 return 0

 # 3. åˆå§‹åŒ– BFS é˜Ÿåˆ—å’Œ visited é›†åˆ
 queue = deque()
 queue.append((start, 0)) # (å½“å‰å¯†ç , å·²ç”¨æ­¥æ•°)
 visited = {start} | deadends_set # å°†èµ·ç‚¹å’Œæ­»äº¡å¯†ç éƒ½åŠ å…¥å·²è®¿é—®é›†åˆ

 # 4. å¼€å§‹ BFS
 while queue:
 current_code, steps = queue.popleft()

 # éå†å½“å‰å¯†ç çš„æ¯ä¸€ä½æ•°å­—
 for i in range(4):
 digit = int(current_code[i])

 # å‘ä¸Šå’Œå‘ä¸‹æ‹¨åŠ¨
 for move in [-1, 1]:
 # è®¡ç®—æ–°æ•°å­—ï¼Œå¤„ç† '0'->'9' å’Œ '9'->'0' çš„å¾ªç¯æƒ…å†µ
 new_digit = (digit + move + 10) % 10

 # æ„å»ºæ–°å¯†ç å­—ç¬¦ä¸²
 new_code = (
 current_code[:i] + str(new_digit) + current_code[i+1:]
 )

 # å¦‚æœæ–°å¯†ç æ˜¯ç›®æ ‡ï¼Œç›´æ¥è¿”å›æ­¥æ•°+1
 if new_code == target:
 return steps + 1

 # å¦‚æœæ–°å¯†ç æ²¡è¢«è®¿é—®è¿‡ï¼ˆä¹Ÿä¸æ˜¯æ­»äº¡å¯†ç ï¼‰
 if new_code not in visited:
 visited.add(new_code)
 queue.append((new_code, steps + 1))

 # 5. é˜Ÿåˆ—ä¸ºç©ºä¹Ÿæ²¡æ‰¾åˆ°ç›®æ ‡ï¼Œè¯´æ˜æ— æ³•åˆ°è¾¾
 return -1

---
## ğŸ¤– Assistant

è¿™ä¸ªå†™æ³•æ˜¯å®Œå…¨å¯ä»¥çš„ï¼Œè€Œä¸”è·Ÿä½ å‰é¢é—®çš„ `level_size = len(queue)` æ˜¯åŒä¸€ä¸ªç‚¹ï¼š**å› ä¸ºä½ æŠŠæ­¥æ•°å¡è¿›äº†é˜Ÿåˆ—é‡Œï¼Œæ‰€ä»¥ä¸éœ€è¦æŒ‰å±‚æ¥æ•°æ­¥æ•°ï¼Œè‡ªç„¶å°±ä¸éœ€è¦ `level_size`ã€‚**

æˆ‘åˆ†å‡ ç‚¹æŠŠä½ è¿™ä»½ä»£ç é‡Œçš„å…³é”®è®¾è®¡è¯´æ¸…æ¥šï¼Œä¹Ÿé¡ºä¾¿æŒ‡å‡ºä¸€ä¸ªå°ç»†èŠ‚å¯ä»¥ä¼˜åŒ–ã€‚

---

### 1. ä¸ºä»€ä¹ˆè¿™é‡Œä¹Ÿä¸éœ€è¦ `level_size`ï¼Ÿ

ä½ çš„å†™æ³•æ ¸å¿ƒæ˜¯è¿™ä¸€è¡Œï¼š

```python
queue.append((start, 0))  # (å½“å‰å¯†ç , å·²ç”¨æ­¥æ•°)
```

ä»¥åŠå¾ªç¯é‡Œï¼š

```python
current_code, steps = queue.popleft()
...
queue.append((new_code, steps + 1))
```

ä¹Ÿå°±æ˜¯è¯´ï¼š

- é˜Ÿåˆ—é‡Œçš„æ¯ä¸ªå…ƒç´ ï¼ŒçŠ¶æ€è‡ªå·±å¸¦ç€ã€Œåˆ°è¾¾å®ƒèŠ±äº†å¤šå°‘æ­¥ã€ï¼›
- ä½ åœ¨ç”Ÿæˆ `new_code` æ—¶ç›´æ¥å†™ `steps + 1`ï¼›
- å½“ä½ å‘ç° `new_code == target` æ—¶ï¼Œ**ç«‹åˆ»è¿”å› `steps + 1`**ï¼š

```python
if new_code == target:
    return steps + 1
```

æ‰€ä»¥è¿™é‡Œæ ¹æœ¬ä¸éœ€è¦ã€Œåˆ†å±‚ã€çš„æ¦‚å¿µï¼Œ`steps` å·²ç»ç²¾ç¡®åœ°è¡¨ç¤ºåˆ°è¾¾è¯¥çŠ¶æ€çš„å±‚æ•°ï¼ˆæ­¥æ•°ï¼‰ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸éœ€è¦ï¼š

```python
level_size = len(queue)
for _ in range(level_size):
    ...
steps += 1
```

é‚£å¥—æŒ‰å±‚è®¡æ•°çš„å†™æ³•äº†ã€‚

æ€»ç»“ä¸€å¥ï¼š
**åªè¦ä½ åœ¨é˜Ÿåˆ—é‡Œå­˜çš„æ˜¯ `(çŠ¶æ€, æ­¥æ•°)`ï¼Œå°±ä¸éœ€è¦ `level_size`ï¼›
åªæœ‰åœ¨é˜Ÿåˆ—é‡Œåªå­˜â€œçŠ¶æ€â€ï¼Œè€Œæ­¥æ•°ç”±å¤–éƒ¨å˜é‡æŒ‰å±‚ç´¯åŠ æ—¶ï¼Œæ‰éœ€è¦ `level_size`ã€‚**

---

### 2. æŠŠ `deadends` åˆè¿› `visited` çš„å†™æ³•æ˜¯å¦ OKï¼Ÿ

ä½ è¿™å¥ï¼š

```python
visited = {start} | deadends_set
```

ç­‰ä»·äºï¼š

```python
visited = set(deadends_set)
visited.add(start)
```

åé¢åˆ¤æ–­ï¼š

```python
if new_code not in visited:
    visited.add(new_code)
    queue.append((new_code, steps + 1))
```

æ•ˆæœæ˜¯ï¼š

- æ­»äº¡å¯†ç ä¸€å¼€å§‹å°±è¢«è§†ä½œâ€œå·²ç»è®¿é—®è¿‡â€ï¼›
- å› æ­¤ BFS æ°¸è¿œä¸ä¼šæŠŠå®ƒä»¬å…¥é˜Ÿï¼Œä¹Ÿå°±ä¸ä¼šä»å®ƒä»¬ç»§ç»­æ‰©å±•ã€‚

è¿™ä¸ªæ€è·¯æ˜¯**æ²¡é—®é¢˜çš„**ï¼Œåªæ˜¯è·Ÿæˆ‘ä¹‹å‰åˆ†æˆä¸¤ä¸ªé›†åˆçš„å†™æ³•ç¨å¾®ä¸ä¸€æ ·ï¼š

- æˆ‘çš„å†™æ³•æ˜¯ï¼š
```python
  dead = set(deadends)
  visited = {start}
  ...
  if neighbor in dead or neighbor in visited:
      continue
  ```
- ä½ çš„å†™æ³•æ˜¯ï¼š
  ```python
  visited = {start} | deadends_set
  if new_code not in visited:
      ...
  ```

ä¸¤ç§åœ¨åŠŸèƒ½ä¸Šæ˜¯ç­‰ä»·çš„ï¼Œå±äºé£æ ¼å·®å¼‚ã€‚

---

### 3. è¿™é‡Œæœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼š`target` åœ¨ deadends é‡Œçš„æƒ…å†µ

ä½ ç°åœ¨çš„é€»è¾‘ï¼š

```python
visited = {start} | deadends_set

...

if new_code == target:
 return steps + 1

if new_code not in visited:
 ...
```

æ³¨æ„ï¼š**ä½ æ˜¯å…ˆåˆ¤æ–­ `new_code == target`ï¼Œå†åˆ¤æ–­ `new_code not in visited`ã€‚**

å¦‚æœå‡ºç°è¿™æ ·çš„è¾“å…¥ï¼š

```text
deadends = ["0201", "0101", "0102", "1212", "2002", "8888"]
target = "8888"
```

- `"8888"` åœ¨ `deadends_set` é‡Œï¼Œå› æ­¤ä¹Ÿåœ¨ `visited` é‡Œï¼›
- ä½†å› ä¸ºä½ å…ˆåˆ¤æ–­ `if new_code == target`ï¼Œ**å°±ç®—å®ƒåœ¨ deadends é‡Œï¼Œä¹Ÿä¼šç›´æ¥è¿”å›æ­¥æ•°+1**ã€‚

æŒ‰é¢˜æ„é€šå¸¸ä¼šè®¤ä¸ºï¼š
**deadends æ˜¯ä¸å…è®¸ç»è¿‡çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬ç›®æ ‡ä¹Ÿä¸åº”è¯¥æ˜¯ deadend**ï¼Œè¿™ç§æƒ…å†µä¸‹æ›´ä¸¥è°¨çš„åšæ³•æ˜¯ï¼š

- ä¸€å¼€å§‹å°±åˆ¤æ–­ï¼š

```python
if target in deadends_set:
 return -1
```

- æˆ–è€…ä¿æŒ deadends å’Œ visited åˆ†å¼€ï¼Œå¹¶åœ¨æ‰©å±•æ—¶ç»Ÿä¸€ç”¨ï¼š

```python
if new_code in deadends_set or new_code in visited:
 continue
```

ç°åœ¨ LeetCode çš„æµ‹è¯•æ•°æ®ä¸€èˆ¬ä¸ä¼šå¡ä½ è¿™ç‚¹ï¼Œä½†ä»â€œä¸¥è°¨â€å’Œâ€œé¢è¯•å®˜æ€ä¹ˆçœ‹â€çš„è§’åº¦ï¼Œè¿™ä¸ªç»†èŠ‚å¯ä»¥æä¸€å¥ï¼Œé¡ºä¾¿å±•ç¤ºä½ å¯¹é¢˜æ„è¾¹ç•Œçš„æ€è€ƒã€‚

---

### 4. è¿™ä»½å†™æ³•æ•´ä½“çš„è¯„ä»· + é¢è¯•å¯ä»¥æ€ä¹ˆè¯´

æ•´ä½“æ¥çœ‹ï¼Œä½ è¿™ä»½ä»£ç ï¼š

- BFS æ¨¡æ¿æ­£ç¡®ï¼›
- ä¸ç”¨ `level_size` æ˜¯åˆç†çš„ï¼Œå› ä¸ºé˜Ÿåˆ—é‡Œå·²ç»å¸¦äº†æ­¥æ•°ï¼›
- æŠŠ deadends åˆå¹¶è¿› visited å±äºä¸€ä¸ªå°ä¼˜åŒ–ï¼Œé¿å…å¤šæ¬¡ set æŸ¥è¯¢ï¼›
- å”¯ä¸€å¯ä»¥åŠ å¼ºçš„ç‚¹æ˜¯ï¼šè€ƒè™‘ `target` æœ¬èº«åœ¨ deadends é‡Œçš„æƒ…å†µï¼Œæ˜¾å¼å¤„ç†ä¸€ä¸‹æ›´ä¸¥è°¨ã€‚

é¢è¯•æ—¶å¦‚æœè¢«é—®åˆ°â€œä¸ºä»€ä¹ˆæ²¡ç”¨ level_sizeâ€ï¼Œå¯ä»¥ç›´æ¥è¯´ï¼š

> æˆ‘è¿™é‡Œé˜Ÿåˆ—é‡Œå­˜çš„æ˜¯ `(çŠ¶æ€, æ­¥æ•°)`ï¼Œæ¯æ¬¡å‡ºé˜Ÿæ—¶å°±çŸ¥é“åˆ°è¾¾è¿™ä¸ªçŠ¶æ€ç”¨äº†å¤šå°‘æ­¥ï¼Œæ‰€ä»¥ä¸éœ€è¦æŒ‰å±‚ç»Ÿè®¡èŠ‚ç‚¹æ•°é‡ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸éœ€è¦ `level_size = len(queue)` è¿™ç§åˆ†å±‚å†™æ³•ã€‚è¿™æ˜¯ BFS çš„å¦ä¸€ç§ç­‰ä»·å†™æ³•ã€‚

---
## ğŸ§‘â€ğŸ’» User

è¿™é“é¢˜å¯ä»¥ç”¨åŒå‘ BFS è¿›è¡Œä¼˜åŒ–å—ï¼Ÿå¯ä»¥è¯çš„å¿…è¦æ€§å¦‚ä½•ï¼Ÿ

---
## ğŸ¤– Assistant

å¯ä»¥ï¼Œç”¨åŒå‘ BFS å®Œå…¨æ²¡é—®é¢˜ï¼›ä½†è¿™é¢˜çš„è§„æ¨¡ä¸‹**æ²¡ä»€ä¹ˆå¿…è¦ï¼Œåªæ˜¯é¢è¯•æ—¶å¯ä»¥å½“åŠ åˆ†é¡¹æ¥è¯´ä¸€å˜´**ã€‚

---

## 1. ç†è®ºä¸Šèƒ½ä¸èƒ½ç”¨åŒå‘ BFSï¼Ÿ

å¯ä»¥çš„ï¼Œæ»¡è¶³ä¸¤ä¸ªå…¸å‹æ¡ä»¶ï¼š

1. å›¾æ˜¯æ— æƒå›¾ï¼ˆæ¯æ­¥ä»£ä»·ç›¸åŒï¼‰ï¼›
2. çŠ¶æ€è½¬ç§»æ˜¯â€œå¯é€†â€çš„ï¼Œæˆ–è€…è¯´ä»ç»ˆç‚¹å¾€å›èµ°è·Ÿä»èµ·ç‚¹å¾€å¤–èµ°æ˜¯ä¸€è‡´çš„ã€‚

æœ¬é¢˜ï¼š

- çŠ¶æ€ï¼š4 ä½æ•°å­—ä¸² `"0123"`ï¼›
- è¾¹ï¼šæŸä¸€ä½ +1 æˆ– -1ï¼ˆ0â†”9 ç¯ç»•ï¼‰ï¼Œä»èµ·ç‚¹ `"0000"` åˆ° targetï¼›
- ä» target å¾€å›èµ°ï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯å¯¹æŸä¸€ä½ +1/-1ï¼Œæ‰€ä»¥å®Œå…¨å¯¹ç§°ã€‚

æ‰€ä»¥å¯ä»¥ï¼š

- ä» `"0000"` å¾€å¤– BFSï¼›
- ä» `target` å¾€å¤– BFSï¼›
- ä¸¤ä¸ªâ€œæ³¢å‰â€åœ¨ä¸­é—´ç›¸é‡ï¼Œåœæ­¢ï¼Œæ­¥æ•° = å‰å‘æ­¥æ•° + åå‘æ­¥æ•°ã€‚

---

## 2. æœ‰æ²¡æœ‰å¿…è¦ï¼Ÿ

**ä»â€œåšé¢˜/é¢è¯•é€šè¿‡â€çš„è§’åº¦ï¼šæ²¡å¿…è¦ã€‚**

- æ€»çŠ¶æ€æ•°æœ€å¤š `10^4`ï¼›
- æ™®é€šå•å‘ BFS æœ€åä¹Ÿå°±æ˜¯æŠŠ 10000 ä¸ªçŠ¶æ€éƒ½æ‰«ä¸€éï¼Œæ—¶é—´ã€å†…å­˜éƒ½éå¸¸è½»æ¾ï¼›
- LeetCode è¿™é¢˜å•å‘ BFS å°±èƒ½è½»æ¾è¿‡ï¼Œä»£ç ä¹Ÿæ›´ç®€å•ï¼Œæ›´ä¸å®¹æ˜“å†™é”™ã€‚

**åŒå‘ BFS å¸¦æ¥çš„å¥½å¤„æ˜¯ï¼š**

- ç†è®ºå¤æ‚åº¦ä» `O(b^d)` é™åˆ° `O(b^{d/2})`ï¼ˆ`b` = branching factorï¼Œ`d` = æœ€çŸ­è·¯å¾„æ·±åº¦ï¼‰ï¼›
- åœ¨çŠ¶æ€ç©ºé—´å·¨å¤§çš„é¢˜ç›®ï¼ˆæ¯”å¦‚å­—ç¬¦ä¸²ç¼–è¾‘ / å›¾æœç´¢ï¼‰é‡Œéå¸¸æœ‰ç”¨ã€‚

ä½†åœ¨è¿™é¢˜ä¸Šåªæ˜¯**å¸¸æ•°çº§åŠ é€Ÿ**ï¼š
`10^4` å˜æˆ `å‡ åƒ`ï¼Œå¯¹çº¿ä¸Šè¯„æµ‹æ²¡ä»»ä½•å‹åŠ›åŒºåˆ«ã€‚

**æ€»ç»“ï¼šè¿™é¢˜åŒå‘ BFS æ˜¯â€œé¢è¯•æ—¶å¯ä»¥æçš„ä¼˜åŒ–æ€è·¯â€ï¼Œä¸æ˜¯â€œå¿…é¡»ç”¨çš„è§£æ³•â€ã€‚**

---

## 3. åŒå‘ BFS å†™æ³•ç¤ºä¾‹ï¼ˆç®€ç‰ˆï¼‰

ç»™ä½ ä¸€ä»½åŒå‘ BFS å†™æ³•ï¼Œå¯¹ç…§ä¸€ä¸‹å•å‘ BFS å¾ˆå¥½ç†è§£ï¼š

```python
from typing import List, Set


class Solution:
    def openLock(self, deadends: List[str], target: str) -> int:
        """åŒå‘ BFS ç‰ˆæœ¬ï¼Œé€»è¾‘ä¸Šæ›´å¿«ï¼Œä½†è¿™é¢˜ä¸ç®—åˆšéœ€ã€‚"""
        start = "0000"
        dead: Set[str] = set(deadends)

        if start in dead:
            return -1
        if start == target:
            return 0
        if target in dead:
            # æ˜¯å¦ç›´æ¥è¿”å› -1 çœ‹ä½ å¦‚ä½•ç†è§£é¢˜æ„ï¼Œè¿™é‡Œä¿å®ˆä¸€ç‚¹ã€‚
            return -1

        # å‰å‘å’Œåå‘ä¸¤ä¸ªè¾¹ç•Œé›†åˆ
        begin_set = {start}
        end_set = {target}

        visited = set(dead)
        visited.add(start)
        visited.add(target)

        steps = 0

        while begin_set and end_set:
            # æ¯æ¬¡æ‰©å±•èŠ‚ç‚¹æ•°æ›´å°‘çš„é‚£ä¸€ä¾§ï¼Œå‡å°åˆ†æ”¯æ•°
            if len(begin_set) > len(end_set):
                begin_set, end_set = end_set, begin_set

            next_begin = set()
            for code in begin_set:
                # ç”Ÿæˆæ‰€æœ‰é‚»å±…
                for nei in self._neighbors(code):
                    # å¦‚æœé‚»å±…åœ¨å¯¹ä¾§è¾¹ç•Œé‡Œï¼Œè¯´æ˜ä¸¤è¾¹ç›¸é‡ï¼Œè¿”å›æ­¥æ•°+1
                    if nei in end_set:
                        return steps + 1
                    if nei in visited:
                        continue
                    visited.add(nei)
                    next_begin.add(nei)

            begin_set = next_begin
            steps += 1

        return -1

    def _neighbors(self, code: str) -> List[str]:
        """ç”Ÿæˆå½“å‰çŠ¶æ€ä¸€æ¬¡è½¬åŠ¨å¯ä»¥è¾¾åˆ°çš„æ‰€æœ‰é‚»å±…ã€‚"""
        res = []
        for i in range(4):
            d = int(code[i])
            for move in (-1, 1):
                nd = (d + move + 10) % 10
                res.append(code[:i] + str(nd) + code[i + 1:])
        return res
```

å¯ä»¥çœ‹åˆ°ï¼š

- ä¸å†ç”¨é˜Ÿåˆ—ï¼Œè€Œæ˜¯ç”¨ä¸¤ä¸ªé›†åˆ `begin_set`ã€`end_set` åˆ†åˆ«è¡¨ç¤ºä¸¤ä¾§â€œå½“å‰è¿™ä¸€å±‚â€çš„æ‰€æœ‰èŠ‚ç‚¹ï¼›
- æ¯ä¸€è½®æ‰©å±•ç»“ç‚¹æ•°æ›´å°‘çš„ä¸€ä¾§ï¼›
- ä¸€æ—¦ä¸¤ä¾§çš„è¾¹ç•Œæœ‰äº¤é›†ï¼Œå°±è¯´æ˜è·¯å¾„åœ¨ä¸­é—´ç›¸é‡äº†ï¼Œç›´æ¥è¿”å›å½“å‰æ­¥æ•° + 1ã€‚

---

## 4. é¢è¯•ä¸­ 30 ç§’å£è¿°è¦ç‚¹

å¦‚æœé¢è¯•å®˜é—®â€œè¿˜èƒ½ä¸èƒ½ä¼˜åŒ– BFSâ€ï¼š

> æˆ‘è¿™é¢˜ç”¨äº†å•å‘ BFSï¼Œä» "0000" å¼€å§‹æœç´¢ï¼ŒçŠ¶æ€æ€»æ•°æœ€å¤š 1 ä¸‡ä¸ªï¼Œå¤æ‚åº¦å·²ç»å¾ˆå°ã€‚
> å¦‚æœç›®æ ‡çŠ¶æ€ç©ºé—´æ›´å¤§ï¼Œå¯ä»¥ç”¨åŒå‘ BFS ä¼˜åŒ–ï¼šåŒæ—¶ä»èµ·ç‚¹å’Œç»ˆç‚¹å¾€ä¸­é—´æœï¼Œæ¯ä¸€è½®æ‰©å±•å½“å‰èŠ‚ç‚¹æ›´å°‘çš„ä¸€è¾¹ï¼Œå½“ä¸¤è¾¹çš„ frontier ç›¸é‡æ—¶å°±å¾—åˆ°äº†æœ€çŸ­è·¯å¾„ã€‚
> ç†è®ºä¸Šè¿™æ ·æŠŠå¤æ‚åº¦ä» O(b^d) é™åˆ° O(b^{d/2})ï¼Œåœ¨å›¾æ¯”è¾ƒå¤§æ—¶æ•ˆæœæ˜æ˜¾ã€‚
> å¯¹è¿™é“é¢˜æ¥è¯´ï¼ŒåŒå‘ BFS æ˜¯ä¸€ç§å¯é€‰ä¼˜åŒ–ï¼Œæ›´å¤šæ˜¯ä»£ç ç»ƒä¹ å’Œé¢è¯•åŠ åˆ†ç‚¹ï¼Œå®é™…è¿è¡Œä¸Šå•å‘ BFS å·²ç»è¶³å¤Ÿã€‚

---
## ğŸ¤– Assistant

å½“ç„¶å¯ä»¥ï¼**åŒå‘ BFS** æ˜¯å¯¹æ ‡å‡† BFS çš„ä¸€ä¸ªç»å…¸ä¸”é‡è¦çš„ä¼˜åŒ–ï¼Œé¢è¯•ä¸­éå¸¸é«˜é¢‘ï¼Œèƒ½ç­”å‡ºæ¥ç»å¯¹æ˜¯åŠ åˆ†é¡¹ã€‚

---

## 1. ä»€ä¹ˆæ˜¯åŒå‘ BFSï¼Ÿä¸ºä»€ä¹ˆä¼šæ›´å¿«ï¼Ÿ

- **å•å‘ BFSï¼š** åƒæ°´æ³¢ä¸€æ ·ï¼Œä»èµ·ç‚¹ `start` å¼€å§‹ï¼Œä¸€åœˆä¸€åœˆå‘å¤–æ‰©æ•£ï¼Œç›´åˆ°ç¢°åˆ°ç»ˆç‚¹ `target`ã€‚
- **åŒå‘ BFSï¼š** åƒæ˜¯ä¸¤ä¸ªäººä»éš§é“ä¸¤ç«¯åŒæ—¶å¼€æŒ–ã€‚ä¸€ä¸ªä» `start` å¼€å§‹æŒ–ï¼ˆæ­£å‘ BFSï¼‰ï¼Œå¦ä¸€ä¸ªåŒæ—¶ä» `target` å¼€å§‹æŒ–ï¼ˆåå‘ BFSï¼‰ï¼Œå½“ä¸¤è¾¹æŒ–é€šï¼ˆç›¸é‡ï¼‰æ—¶ï¼Œæœç´¢å°±ç»“æŸäº†ã€‚

**ä¸ºä»€ä¹ˆæ›´å¿«ï¼Ÿ**
BFS çš„æœç´¢èŒƒå›´åƒä¸€ä¸ªåœ†ï¼Œå…¶é¢ç§¯ï¼ˆæœç´¢çš„èŠ‚ç‚¹æ•°ï¼‰è·ŸåŠå¾„ï¼ˆæ­¥æ•° `d`ï¼‰æ˜¯**æŒ‡æ•°å…³ç³»**ã€‚

- **å•å‘ BFSï¼š** æœç´¢ä¸€ä¸ªåŠå¾„ä¸º `d` çš„å¤§åœ†ï¼Œæœç´¢èŠ‚ç‚¹æ•°çº¦ç­‰äº `b^d`ï¼ˆ`b` æ˜¯åˆ†æ”¯å› å­ï¼‰ã€‚
- **åŒå‘ BFSï¼š** æœç´¢ä¸¤ä¸ªåŠå¾„ä¸º `d/2` çš„å°åœ†ï¼Œæ€»æœç´¢èŠ‚ç‚¹æ•°çº¦ç­‰äº `2 * b^(d/2)`ã€‚

å› ä¸º `d` åœ¨æŒ‡æ•°ä¸Šï¼Œæ‰€ä»¥ `b^d` >> `2 * b^(d/2)`ã€‚ç®€å•æ¥è¯´ï¼Œ**åŒå‘ BFS æŠŠæŒ‡æ•°çº§çš„å¤æ‚åº¦ç›´æ¥ç äº†ä¸€åŠ**ï¼Œè¿™æ˜¯å·¨å¤§çš„æ€§èƒ½æå‡ã€‚

![](https://g.yuque.com/gr/plain/2022/10/d730a996-5e5d-4f0e-b2d9-354972a933f7.png)

---

## 2. å¦‚ä½•å®ç°åŒå‘ BFSï¼Ÿ

æ ¸å¿ƒæ€è·¯ï¼š

1. åˆ›å»º**ä¸¤ä¸ª**é˜Ÿåˆ—ï¼š`queue_start` ä»èµ·ç‚¹å¼€å§‹ï¼Œ`queue_end` ä»ç»ˆç‚¹å¼€å§‹ã€‚
2. åˆ›å»º**ä¸¤ä¸ª** visited é›†åˆï¼š`visited_start` å’Œ `visited_end`ï¼Œç”¨æ¥è®°å½•ä¸¤è¾¹å„è‡ªè®¿é—®è¿‡çš„èŠ‚ç‚¹ã€‚
3. **äº¤æ›¿è¿›è¡Œ**ï¼š
 - å…ˆä» `queue_start` æ‰©å±•ä¸€å±‚ã€‚å¯¹äºæ¯ä¸ªæ–°èŠ‚ç‚¹ï¼Œæ£€æŸ¥å®ƒæ˜¯å¦åœ¨ `visited_end` é‡Œå‡ºç°è¿‡ã€‚å¦‚æœå‡ºç°ï¼Œè¯´æ˜ç›¸é‡äº†ï¼Œç›´æ¥è¿”å›æ€»æ­¥æ•°ã€‚
 - å†ä» `queue_end` æ‰©å±•ä¸€å±‚ã€‚å¯¹äºæ¯ä¸ªæ–°èŠ‚ç‚¹ï¼Œæ£€æŸ¥å®ƒæ˜¯å¦åœ¨ `visited_start` é‡Œå‡ºç°è¿‡ã€‚å¦‚æœå‡ºç°ï¼Œä¹Ÿè¯´æ˜ç›¸é‡äº†ï¼Œè¿”å›æ€»æ­¥æ•°ã€‚
4. **ä¼˜åŒ–**ï¼šä¸ºäº†è®©ä¸¤ä¸ªæœç´¢åœˆå¤§å°å·®ä¸å¤šï¼Œæ¯æ¬¡éƒ½ä¼˜å…ˆæ‰©å±•**èŠ‚ç‚¹æ•°è¾ƒå°‘**çš„é‚£ä¸ªé˜Ÿåˆ—ã€‚

---

## 3. è¿™é“é¢˜çš„å¿…è¦æ€§å¦‚ä½•ï¼Ÿ

**ç»“è®ºï¼š**

- **ä»æ€§èƒ½è§’åº¦**ï¼š**å®Œå…¨æ²¡å¿…è¦**ã€‚è¿™é¢˜çŠ¶æ€æ€»æ•°æœ€å¤š 10000 ä¸ªï¼Œå•å‘ BFS å‡ ä¹æ˜¯ç¬æ—¶å®Œæˆçš„ã€‚åŒå‘ BFS å¸¦æ¥çš„ä¼˜åŒ–åœ¨è¿™é‡Œå¾®ä¸è¶³é“ï¼Œå±äºâ€œæ€é¸¡ç”¨ç‰›åˆ€â€ã€‚
- **ä»é¢è¯•è§’åº¦**ï¼š**éå¸¸æœ‰å¿…è¦**ã€‚é¢è¯•å®˜é—®è¿™ä¸ªé—®é¢˜ï¼Œä¸æ˜¯æƒ³è®©ä½ çœŸçš„å»ä¼˜åŒ–è¿™é“é¢˜ï¼Œè€Œæ˜¯æƒ³è€ƒå¯Ÿä½ **æ˜¯å¦çŸ¥é“è¿™ä¸ªç»å…¸çš„ä¼˜åŒ–æŠ€å·§**ã€‚è¿™æ˜¯ä¸€ä¸ªå±•ç¤ºä½ ç®—æ³•çŸ¥è¯†å¹¿åº¦å’Œæ·±åº¦çš„ç»ä½³æœºä¼šã€‚

**é¢è¯•å®˜å¿ƒç†ï¼š**
> â€œè¿™å°å­çŸ¥é“ç”¨ BFSï¼Œä¸é”™ã€‚ä½†ä»–çŸ¥ä¸çŸ¥é“ BFS è¿˜æœ‰ä¼˜åŒ–ç©ºé—´ï¼Ÿå¦‚æœä»–èƒ½ä¸»åŠ¨æå‡ºåŒå‘ BFSï¼Œè¯´æ˜ä»–ä¸æ˜¯åªä¼šèƒŒæ¨¡æ¿ï¼Œè€Œæ˜¯çœŸæ­£ç†è§£äº†ç®—æ³•çš„ç“¶é¢ˆå’Œä¼˜åŒ–æ–¹å‘ã€‚â€

---

## 4. åŒå‘ BFS ä»£ç å®ç°

```python
from collections import deque
from typing import List, Set

class Solution:
    def openLock(self, deadends: List[str], target: str) -> int:
        """ä½¿ç”¨åŒå‘ BFS ä¼˜åŒ–æ±‚è§£ã€‚"""
        start = "0000"
        dead: Set[str] = set(deadends)

        if start in dead or target in dead:
            return -1
        if start == target:
            return 0

        # 1. åˆå§‹åŒ–åŒå‘ BFS çš„æ•°æ®ç»“æ„
        queue_start = deque([(start, 0)])
        visited_start = {start}
        
        queue_end = deque([(target, 0)])
        visited_end = {target}

        while queue_start and queue_end:
            
            # 2. ä¼˜åŒ–ï¼šæ€»æ˜¯ä»èŠ‚ç‚¹æ•°è¾ƒå°‘çš„é˜Ÿåˆ—å¼€å§‹æ‰©å±•
            if len(queue_start) > len(queue_end):
                queue_start, queue_end = queue_end, queue_start
                visited_start, visited_end = visited_end, visited_start

            # 3. æ‰©å±•ä¸€å±‚ (ä»è¾ƒå°çš„é˜Ÿåˆ—å¼€å§‹)
            current_code, steps = queue_start.popleft()

            # éå†é‚»å±…
            for i in range(4):
                digit = int(current_code[i])
                for move in [-1, 1]:
                    new_digit = (digit + move + 10) % 10
                    new_code = (
                        current_code[:i] + str(new_digit) + current_code[i+1:]
                    )

                    # 4. ç¢°æ’æ£€æµ‹ï¼šå¦‚æœæ–°èŠ‚ç‚¹åœ¨å¯¹æ–¹çš„ visited é›†åˆé‡Œï¼Œè¯´æ˜ç›¸é‡äº†
                    if new_code in visited_end:
                        # æ‰¾åˆ°å¯¹æ–¹é˜Ÿåˆ—é‡Œè¯¥èŠ‚ç‚¹çš„ä¿¡æ¯
                        for code, end_steps in queue_end:
                            if code == new_code:
                                return steps + 1 + end_steps
                        # å¦‚æœåœ¨ visited_end ä½†ä¸åœ¨ queue_endï¼Œè¯´æ˜å¯¹æ–¹å·²ç»å¤„ç†å®Œè¯¥å±‚
                        # è¿™ç§æƒ…å†µéœ€è¦æ›´å¤æ‚çš„æ­¥æ•°è®°å½•ï¼Œæ›´ç®€å•çš„åšæ³•æ˜¯è®© visited ä¹Ÿå­˜æ­¥æ•°
                        # ä½†ä¸ºäº†ç®€æ´ï¼Œè¿™é‡Œå‡è®¾èƒ½æ‰¾åˆ°ã€‚æ›´ç¨³å¦¥çš„å®ç°æ˜¯ visited å­˜ (state, step)
                        # ä¸è¿‡æœ¬é¢˜æ­¥æ•°æ˜¯äº¤æ›¿çš„ï¼Œæ‰€ä»¥ç›´æ¥ç›¸åŠ å³å¯ã€‚
                        # è¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ç§æ›´ç®€å•çš„æ–¹å¼å¤„ç†æ­¥æ•°ï¼š
                        # åœ¨ `visited` ä¸­å­˜å‚¨æ­¥æ•°ï¼Œè€Œä¸æ˜¯é˜Ÿåˆ—ä¸­
                        # è¿™é‡Œä¸ºäº†ä»£ç ç®€æ´ï¼Œæˆ‘ä»¬è¿˜æ˜¯å‡è®¾åœ¨é˜Ÿåˆ—ä¸­ã€‚
                        # æ­£ç¡®çš„æ­¥æ•°è®¡ç®—é€»è¾‘ï¼š
                        # `steps_from_start = steps + 1`
                        # `steps_from_end` éœ€è¦ä» `visited_end` ä¸­è·å–
                        # è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªæ›´ç®€å•çš„æ­¥æ•°æ¨¡å‹æ¥å†™
                        pass # è§ä¸‹é¢æ›´ç¨³å¦¥çš„å†™æ³•

                    if new_code in dead or new_code in visited_start:
                        continue

                    visited_start.add(new_code)
                    queue_start.append((new_code, steps + 1))
        return -1


# æ›´ç¨³å¦¥ä¸”æ¸…æ™°çš„åŒå‘ BFS å†™æ³• (æ¨èé¢è¯•æ—¶è®²è¿™ä¸ªæ€è·¯)
class Solution_Recommended:
    def openLock(self, deadends: List[str], target: str) -> int:
        start = "0000"
        dead = set(deadends)
        if start in dead: return -1
        if start == target: return 0

        # visited å­˜ {state: steps}
        visited_start = {start: 0}
        q_start = deque([start])

        visited_end = {target: 0}
        q_end = deque([target])

        while q_start and q_end:
            if len(q_start) > len(q_end):
                q_start, q_end = q_end, q_start
                visited_start, visited_end = visited_end, visited_start
            
            # æ‰©å±•ä¸€å±‚
            current_code = q_start.popleft()
            steps = visited_start[current_code]

            for i in range(4):
                digit = int(current_code[i])
                for move in [-1, 1]:
                    new_digit = (digit + move + 10) % 10
                    new_code = current_code[:i] + str(new_digit) + current_code[i+1:]

                    if new_code in visited_end:
                        return steps + 1 + visited_end[new_code]
                    
                    if new_code in dead or new_code in visited_start:
                        continue
                    
                    visited_start[new_code] = steps + 1
                    q_start.append(new_code)
        
        return -1

```

---

## 5. é¢è¯•ä¸­ 30 ç§’å£è¿°æ€è·¯

> å¯¹äºè¿™é“é¢˜ï¼Œæ ‡å‡†çš„ BFS å·²ç»è¶³å¤Ÿå¿«äº†ï¼Œå› ä¸ºçŠ¶æ€ç©ºé—´å¾ˆå°ã€‚ä½†å¦‚æœçŠ¶æ€ç©ºé—´éå¸¸å¤§ï¼Œæ¯”å¦‚å¯†ç æ˜¯ 8 ä½è€Œä¸æ˜¯ 4 ä½ï¼Œé‚£ä¹ˆå•å‘ BFS å¯èƒ½ä¼šè¶…æ—¶ã€‚
> è¿™æ—¶å¯ä»¥ç”¨**åŒå‘ BFS** è¿›è¡Œä¼˜åŒ–ã€‚æˆ‘ä»¬åŒæ—¶ä»èµ·ç‚¹ "0000" å’Œç»ˆç‚¹ `target` å¼€å§‹æœç´¢ï¼Œç›¸å½“äºä¸¤ä¸ª BFS åŒæ—¶è¿›è¡Œã€‚å½“ä¸¤ä¸ªæœç´¢å‰æ²¿ç›¸é‡æ—¶ï¼Œå°±æ‰¾åˆ°äº†æœ€çŸ­è·¯å¾„ã€‚
> è¿™æ ·åšèƒ½æŠŠæœç´¢æ·±åº¦ä» `d` é™åˆ° `d/2`ï¼Œç”±äº BFS çš„å¤æ‚åº¦æ˜¯æŒ‡æ•°çº§çš„ï¼Œè¿™ä¼šå¸¦æ¥å·¨å¤§çš„æ€§èƒ½æå‡ã€‚å®ç°ä¸Šéœ€è¦ä¸¤ä¸ªé˜Ÿåˆ—å’Œä¸¤ä¸ª visited é›†åˆï¼Œå¹¶æ¯æ¬¡ä¼˜å…ˆæ‰©å±•è¾ƒå°çš„é˜Ÿåˆ—ã€‚

---
## ğŸ§‘â€ğŸ’» User

å…³äºé”®ç›˜é”è¿™é“é¢˜ï¼Œæˆ‘ä¸‹é¢çš„ä»£ç å“ªé‡Œæœ‰é—®é¢˜
class Solution:
 def openLock(self, deadends: List[str], target: str) -> int:
 start = '0000'
 deadends_set = set(deadends)
 if start == target:
 return 0
 dq = collections.deque([(start, 0)])
 visited = {start}
 while dq:
 curr_state, steps = dq.popleft()
 if curr_state == target:
 return steps
 for idx in range(4):
 digit = int(curr_state[idx])
 for move in [-1, 1]:
 new_digit = (digit + move + 10) % 10
 new_state = curr_state[:idx] + str(new_digit) + curr_state[idx+1:]
 if new_state in deadends_set:
 continue
 if new_state not in visited:
 visited.add(new_state)
 dq.append((new_state, steps + 1))
 return -1

---
## ğŸ¤– Assistant

æœ€å¤§çš„é—®é¢˜æ˜¯ä¸€è¡Œï¼š`return -1` çš„ç¼©è¿›å†™é”™äº†ã€‚

ä½ ç°åœ¨çš„ç»“æ„æ˜¯ï¼š

```python
while dq:
    curr_state, steps = dq.popleft()
    if curr_state == target:
        return steps
    for idx in range(4):
        ...
                    if new_state not in visited:
                        visited.add(new_state)
                        dq.append((new_state, steps + 1))
    return -1   # â† è¿™ä¸€è¡Œåœ¨ while é‡Œé¢
```

è¿™æ ·ä¼šå¯¼è‡´ï¼š

- `while dq:` åªä¼šæ‰§è¡Œ**ä¸€æ¬¡å¾ªç¯**ï¼š
 - åªæŠŠé˜Ÿåˆ—é‡Œç¬¬ä¸€ä¸ªçŠ¶æ€ `curr_state` çš„ 8 ä¸ªé‚»å±…éƒ½æ‰©å±•å®Œï¼›
 - ç„¶åç«‹åˆ»æ‰§è¡Œ `return -1`ï¼›
- å³ä½¿é˜Ÿåˆ—é‡Œå·²ç»åŠ å…¥äº†å¾ˆå¤šæ–°çš„çŠ¶æ€ï¼Œä¹Ÿå®Œå…¨ä¸ä¼šå†ç»§ç»­ BFSã€‚

æ‰€ä»¥ä½ è¿™æ®µä»£ç çš„è¡Œä¸ºæ˜¯ï¼š

> â€œå¦‚æœä¸€å¼€å§‹å¼¹å‡ºçš„é‚£ä¸ªçŠ¶æ€ä¸æ˜¯ targetï¼Œå°±ç›´æ¥è®¤å®šä¸å¯è¾¾ï¼Œè¿”å› -1â€ã€‚

æ˜¾ç„¶æ˜¯é”™çš„ï¼Œæ‰€æœ‰éœ€è¦ 2 æ­¥ä»¥ä¸Šæ‰èƒ½åˆ°è¾¾çš„æƒ…å†µéƒ½ä¼šè¢«åˆ¤æˆ -1ã€‚

---

### æ­£ç¡®ä½ç½®ï¼š`return -1` è¦æ”¾åœ¨ while å¾ªç¯å¤–é¢

åº”è¯¥æ”¹æˆï¼š

```python
class Solution:
    def openLock(self, deadends: List[str], target: str) -> int:
        start = '0000'
        deadends_set = set(deadends)

        # èµ·ç‚¹æ˜¯æ­»äº¡çŠ¶æ€ï¼Œæ°¸è¿œæ‰“ä¸å¼€
        if start in deadends_set:
            return -1

        if start == target:
            return 0

        dq = collections.deque([(start, 0)])
        visited = {start}

        while dq:
            curr_state, steps = dq.popleft()
            if curr_state == target:
                return steps

            for idx in range(4):
                digit = int(curr_state[idx])
                for move in [-1, 1]:
                    new_digit = (digit + move + 10) % 10
                    new_state = (
                        curr_state[:idx]
                        + str(new_digit)
                        + curr_state[idx + 1:]
                    )

                    if new_state in deadends_set:
                        continue

                    if new_state not in visited:
                        visited.add(new_state)
                        dq.append((new_state, steps + 1))

        # åªæœ‰å½“é˜Ÿåˆ—å½»åº•ç©ºäº†è¿˜æ²¡æ‰¾åˆ° targetï¼Œæ‰è¯´æ˜ä¸å¯è¾¾
        return -1
```

å…³é”®åŒºåˆ«å°±æ˜¯ï¼š

- `return -1` **å¯¹é½åˆ° while å¤–é¢**ï¼›
- å«ä¹‰å˜æˆï¼š
â€œåªæœ‰å½“ BFS æŠŠæ‰€æœ‰èƒ½åˆ°è¾¾çš„çŠ¶æ€éƒ½éå†å®Œï¼ˆé˜Ÿåˆ—ç©ºï¼‰ï¼Œè¿˜æ²¡é‡åˆ° targetï¼Œæ‰è¿”å› -1â€ã€‚

---

### å¦å¤–ä¸¤ä¸ªå°å»ºè®®ï¼ˆä¸æ˜¯è‡´å‘½ bugï¼Œä½†æ›´ä¸¥è°¨ï¼‰

1. èµ·ç‚¹åœ¨æ­»é”é‡Œè¦ç›´æ¥è¿”å› -1ï¼ˆä¸Šé¢å·²åŠ ï¼‰ï¼š
```python
if start in deadends_set:
 return -1
```

2. `curr_state == target` çš„åˆ¤æ–­ï¼Œå’Œå‰é¢ `start == target` æœ‰ç‚¹é‡å¤ï¼Œä½†ä¸å½±å“æ­£ç¡®æ€§ï¼Œå¯ä»¥ä¿ç•™ï¼Œä¹Ÿå¯ä»¥åªä¿ç•™å¾ªç¯é‡Œçš„é‚£ä¸€ä¸ªã€‚

---

### é¢è¯•é‡Œå¯ä»¥æ€ä¹ˆè§£é‡Šè¿™ä¸ª bugï¼ˆå£è¿°è¦ç‚¹ï¼‰

> æˆ‘çš„ä»£ç ä¸€å¼€å§‹æœ‰ä¸ªç¼©è¿›é—®é¢˜ï¼ŒæŠŠ `return -1` å†™åœ¨äº† while å¾ªç¯é‡Œé¢ã€‚
> è¿™æ · BFS åªä¼šå¤„ç†é˜Ÿåˆ—é‡Œçš„ç¬¬ä¸€ä¸ªçŠ¶æ€ï¼Œå¦‚æœç¬¬ä¸€æ­¥ä¸èƒ½ç›´æ¥åˆ°è¾¾ç›®æ ‡å°±ç›´æ¥è¿”å› -1ï¼Œç›¸å½“äºåªæœç´¢äº†ä¸€å±‚ã€‚
> æ­£ç¡®çš„åšæ³•æ˜¯ï¼šåªæœ‰å½“é˜Ÿåˆ—å½»åº•ç©ºäº†è¿˜æ²¡æ‰¾åˆ°ç›®æ ‡ï¼Œæ‰è¯´æ˜ç›®æ ‡ä¸å¯è¾¾ï¼Œæ‰€ä»¥ `return -1` å¿…é¡»æ”¾åœ¨ while å¾ªç¯å¤–é¢ã€‚
